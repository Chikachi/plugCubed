/*
 Copyright (c) 2012-2013 by Thomas "TAT" Andresen and other contributors

 Permission to use this software for any purpose without fee is hereby granted, provided
 that the above copyright notice and this permission notice appear in all copies.

 Permission to copy and/or edit this software or parts of it for any purpose is permitted,
 provided that the following points are followed.
 - The above copyright notice and this permission notice appear in all copies
 - Within two (2) days after modification is proven working, any modifications are send back
   to the original authors to be inspected with the goal of inclusion in the official software
 - Any edited version are only test versions and not permitted to be run as a final product
 - Any edited version aren't to be distributed
 - Any edited version have the prerelease version set to something that can be distinguished
   from a version used in the original software

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHORS DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHORS
 BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER
 RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/
"undefined"!==typeof plugCubed&&plugCubed.close();function w(l){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test("#"===l.substr(0,1)?l:"#"+l)}Math.ca=function(){return 1+Math.floor(10*Math.random())};var plugCubed,I;
define("plugCubed/Model","underscore app/base/Class app/facades/ChatFacade app/store/LocalStorage app/utils/Utilities app/models/RoomModel app/base/Context app/events/MediaCurateEvent app/net/Socket app/net/SocketIO app/models/TheUserModel lang/Lang app/views/room/AudienceView app/events/RoomJoinEvent app/events/RoomStateEvent".split(" "),function(l,p,k,f,g,d,x,J,R,S,W,X,s){function q(a,b,c){return void 0===I[a]||void 0===I[a][b]?c:I[a][b]}function t(a,b,c){void 0===I[a]&&(I[a]={});I[a][b]=c}function u(a){a||
(a=API.getUser().id);return"50aeb31696fba52c3ca0adb6"==a}function C(a){a||(a=API.getUser().id);return-1<["5121578196fba506408bb9eb"].indexOf(a)}function D(a){a||(a=API.getUser().id);return-1<["5112c273d6e4a94ec0554792","50b1961c96fba57db2230417","50aeb077877b9217e2fbff00"].indexOf(a)}function v(a,b){if(a){var c=$("#chat-messages"),e=c.scrollTop()>c[0].scrollHeight-c.height()-20;c.append('<div class="chat-update"><span class="chat-text" style="color:#'+(b?b:"d1d1d1")+'">'+a+"</span></div>");e&&c.scrollTop(c[0].scrollHeight)}}
function E(a){if(void 0!==a){F=!0;h={};n={};if(void 0!==a.colors){if($("body").css("background-color",a.colors.background?"#"+a.colors.background:""),void 0!==a.colors.chat){var b={},c;for(c in a.colors.chat)-1<"admin ambassador bouncer cohost featureddj host manager".split(" ").indexOf(c)&&w(a.colors.chat[c])&&(b[c]="#"===a.colors.chat[c].substr(0,1)?a.colors.chat[c].substr(1):a.colors.chat[c]);h=b}}else $("body").css("background-color","");if(void 0!==a.images){s.defaultRoomElements();if(void 0!==
a.images.audience){b=$.extend([],s.roomElements);for(c in s.roomElements){var e=s.roomElements[c];e.image.src===s.arch.src&&a.images.audience.arch&&"false"===a.images.audience.arch&&b.splice(b.indexOf(e),1);e.image.src===s.mountain.src&&a.images.audience.mountain&&"false"===a.images.audience.mountain&&b.splice(b.indexOf(e),1);e.image.src===s.cactus.src&&a.images.audience.cactus&&"false"===a.images.audience.cactus&&b.splice(b.indexOf(e),1);e.image.src===s.cloud.src&&a.images.audience.cloud&&"false"===
a.images.audience.cloud&&b.splice(b.indexOf(e),1)}$("#room-wheel").css("display",a.images.audience.da&&"false"===a.images.audience.da?"none":"");s.roomElements=b}else $("#room-wheel").css("display","");x.trigger("audience:redraw");$("body").css("background-image",a.images.background?'url("'+a.images.background+'")':"");void 0!==a.images.booth?$("#dj-console").css("background-image",a.images.booth.booth?'url("'+a.images.booth.booth+'")':""):$("#dj-console").css("background-image","");n=a.images.icons}else s.defaultRoomElements(),
$("#room-wheel").css("display",""),$("body").css("background-image",""),$("#dj-console").css("background-image",""),x.trigger("audience:redraw");plugCubed.J();plugCubed.O()}}function K(){var a=d.get("description"),b=plugCubed.settings.useRoomSettings[window.location.pathname.split("/")[1]],b=void 0===b||!0===b?!0:!1;if(-1<a.indexOf("@p3=")){a=a.substr(a.indexOf("@p3=")+4);-1<a.indexOf(" ")&&a.indexOf(" ");-1<a.indexOf("\n")&&a.indexOf("\n");if(b)return $.getJSON(a,function(a){E(a)});F=!0;plugCubed.J()}}
function A(a){a=a.trim();"@"===a.substr(0,1)&&(a=a.substr(1));var b=API.getUsers(),c;for(c in b)if(("string"!==typeof a?0:b[c].username.toLowerCase()===a.toLowerCase())||("string"!==typeof a?0:b[c].id.toLowerCase()===a.toLowerCase()))return b[c];return null}function B(a){a=A(a);if(null===a)API.chatLog(plugCubed.d("error.userNotFound"));else{var b,c,e,d,f=a.djPoints+a.curatorPoints+a.listenerPoints;c=API.getWaitListPosition(a.id);var h=API.getBoothPosition(a.id);e=API.getDJs();d=a.language;var x=k.uiLanguages.concat(k.chatLanguages);
for(b in x)x.value===d&&(d=x[b].label);b=API.hasPermission(a.id,API.ROLE.ADMIN)?plugCubed.d("ranks.admin"):API.hasPermission(a.id,API.ROLE.AMBASSADOR)?plugCubed.d("ranks.ambassador"):API.hasPermission(a.id,API.ROLE.HOST)?plugCubed.d("ranks.host"):API.hasPermission(a.id,API.ROLE.COHOST)?plugCubed.d("ranks.cohost"):API.hasPermission(a.id,API.ROLE.MANAGER)?plugCubed.d("ranks.manager"):API.hasPermission(a.id,API.ROLE.BOUNCER)?plugCubed.d("ranks.bouncer"):API.hasPermission(a.id,API.ROLE.FEATUREDDJ)?plugCubed.d("ranks.featureddj"):
plugCubed.d("ranks.regular");d=0===h?plugCubed.d("info.djing"):-1<h?plugCubed.d("info.inbooth",h+1,e.length):-1<c?plugCubed.d("info.inwaitlist",c,API.getWaitList().length):plugCubed.d("info.notinlist");switch(a.status){default:c=plugCubed.d("status.available");break;case API.STATUS.AFK:c=plugCubed.d("status.afk");break;case API.STATUS.WORKING:c=plugCubed.d("status.working");break;case API.STATUS.SLEEPING:c=plugCubed.d("status.sleeping")}switch(a.vote){case -1:e=plugCubed.d("vote.meh");break;default:e=
plugCubed.d("vote.undecided");break;case 1:e=plugCubed.d("vote.woot")}0===h&&(e=plugCubed.d("vote.djing"));h=void 0;u(a.id)&&(h=plugCubed.d("info.specialTitles.developer"));C(a.id)&&(h=plugCubed.d("info.specialTitles.sponsor"));D(a.id)&&(h=plugCubed.d("info.specialTitles.vip"));f='<table style="width:100%;color:#CC00CC"><tr><td colspan="2"><strong>'+plugCubed.d("info.name")+'</strong>: <span style="color:#FFFFFF">'+g.cleanTypedString(a.username)+"</span></td></tr>"+(h?'<tr><td colspan="2"><strong>'+
plugCubed.d("info.title")+'</strong>: <span style="color:#FFFFFF">'+h+"</span></td></tr>":"")+'<tr><td colspan="2"><strong>'+plugCubed.d("info.id")+'</strong>: <span style="color:#FFFFFF">'+a.id+"</span></td></tr><tr><td><strong> "+plugCubed.d("info.rank")+'</strong>: <span style="color:#FFFFFF">'+b+"</span></td><td><strong>"+plugCubed.d("info.joined")+'</strong>: <span style="color:#FFFFFF">'+plugCubed.S(q(a.id,"joinTime",Date.now()))+"</span></td></tr><tr><td><strong>"+plugCubed.d("info.status")+
'</strong>: <span style="color:#FFFFFF">'+c+"</span></td><td><strong> "+plugCubed.d("info.vote")+'</strong>: <span style="color:#FFFFFF">'+e+'</span></td></tr><tr><td colspan="2"><strong>'+plugCubed.d("info.position")+'</strong>: <span style="color:#FFFFFF">'+d+"</span></td></tr><tr><td><strong>"+plugCubed.d("info.points")+'</strong>: <span style="color:#FFFFFF" title = "'+plugCubed.d("info.pointType.dj",a.djPoints)+"&#13; "+plugCubed.d("info.pointType.listener",a.listenerPoints)+"&#13; "+plugCubed.d("info.pointType.curator",
a.curatorPoints)+'">'+f+"</span></td><td><strong> "+plugCubed.d("info.fans")+'</strong>: <span style="color:#FFFFFF">'+a.fans+"</span></td></tr><tr><td><strong>"+plugCubed.d("info.wootCount")+'</strong>: <span style="color:#FFFFFF">'+q(a.id,"wootcount",0)+"</span></td><td><strong>"+plugCubed.d("info.mehCount")+'</strong>: <span style="color:#FFFFFF">'+q(a.id,"mehcount",0)+'</span></td></tr><tr><td colspan="2"><strong>'+plugCubed.d("info.ratio")+'</strong>: <span style="color:#FFFFFF">';a:if(h=q(a.id,
"wootcount",0),b=q(a.id,"mehcount",0),0===b)h=0===h?"0:0":"1:0";else{for(c=1;c<=b;c++)if(e=c*(h/b),0===e%1){h=e+":"+c;break a}h=void 0}v(f+h+'</span></td></tr><tr><td><strong>Disconnects</strong>: <span style="color:#FFFFFF">'+q(a.id,"disconnects",0)+"</td></tr></table>")}}function L(){var a=$('<table style="width:100%;color:#CC00CC"/>'),b=API.getUsers(),c;for(c in b)a.append($("<tr/>").append($("<td/>").append(b[c].username)).append($("<td/>").append(b[c].id)));v($("<div/>").append(a).html())}function T(a){var b,
c;c=0<API.getDJs().length&&API.getDJs()[0].id==a.id;var e="FFFFFF";b=!1!==a.curated?"curate":u(a.id)?"p3dev":C(a.id)?"p3sponsor":D(a.id)?"p3vip":API.hasPermission(a.id,API.ROLE.ADMIN)?"admin":API.hasPermission(a.id,API.ROLE.AMBASSADOR)?"ambassador":API.hasPermission(a.id,API.ROLE.HOST)?"host":API.hasPermission(a.id,API.ROLE.COHOST)?"host":API.hasPermission(a.id,API.ROLE.MANAGER)?"manager":API.hasPermission(a.id,API.ROLE.BOUNCER)?"bouncer":API.hasPermission(a.id,API.ROLE.FEATUREDDJ)?"fdj":"void";if(c)e=
"66FFFF";else switch(a.vote){case -1:e="ED1C24";break;case 1:e="3FFF00";break;default:e="FFFFFF"}if(c)c="current";else if(void 0!==a.vote)switch(a.vote){case -1:c="meh";break;case 1:c="woot";break;default:c="undecided"}else c="undecided";U("void"===b?"void":b+"_"+c,e,a.username)}function U(a,b,c){$("#side-left .sidebar-content").append($("<p></p>").append($("<span></span>").append($("<span></span>").addClass(a)).css("cursor","pointer").css("color","#"+b).mousedown(function(a){switch(a.which){case 1:$("#chat-input-field").val($("#chat-input-field").val()+
"@"+c+" ").focus();break;case 3:(API.hasPermission(void 0,API.ROLE.BOUNCER)||u())&&B(c)}}).html(function(a,b){return b+g.cleanTypedString(23<c.length?c.substr(0,20)+"...":c)})))}function G(){document.getElementById("chat-sound").playMentionSound()}function M(){if(0!==API.getDJs().length){var a=API.getDJs()[0];null!==a&&a!=API.getUser()&&$("#button-vote-positive").click()}}function H(){$("#side-left .sidebar-content").bind("contextmenu",function(){return!1});$("#side-left .sidebar-content h1,#side-left .sidebar-content h3,#side-left .sidebar-content p,#side-left .sidebar-content hr").remove();
$("#side-left .sidebar-content").append('<h1 class="users">Users: '+API.getUsers().length+"</h1>");var a=API.getWaitListPosition(),a=$("<h3></h3>").addClass("waitlistspot").text("Waitlist: "+(-1!=a?a+" / ":"")+API.getWaitList().length);$("#side-left .sidebar-content").append(a).append("<hr />");a=API.getUsers();a.sort(function(a,b){function d(a){return u(a.id)?20:C(a.id)?19:D(a.id)?18:API.hasPermission(a.id,API.ROLE.ADMIN)?API.ROLE.ADMIN:API.hasPermission(a.id,API.ROLE.AMBASSADOR)?API.ROLE.AMBASSADOR:
API.hasPermission(a.id,API.ROLE.HOST)?API.ROLE.HOST:API.hasPermission(a.id,API.ROLE.COHOST)?API.ROLE.COHOST:API.hasPermission(a.id,API.ROLE.MANAGER)?API.ROLE.MANAGER:API.hasPermission(a.id,API.ROLE.BOUNCER)?API.ROLE.BOUNCER:API.hasPermission(a.id,API.ROLE.FEATUREDDJ)?API.ROLE.FEATUREDDJ:API.ROLE.NONE}var g=d(a),h=d(b);return g<h?1:g>h?-1:0});for(var b in a)T(a[b])}function N(){var a=[$("<div />").addClass("afkTimer").css("left",566),$("<div />").addClass("afkTimer").css("left",256),$("<div />").addClass("afkTimer").css("left",
181),$("<div />").addClass("afkTimer").css("left",104),$("<div />").addClass("afkTimer").css("left",22)],b;for(b in a)$("#dj-booth").append(a[b])}function O(){$("#dj-booth .afkTimer").remove()}function V(){for(var a=API.getDJs(),b=$("#dj-booth .afkTimer"),c=0;5>c;c++)if(c>=a.length)$(b[c]).text("");else{var e=Date.now()-q(a[c].id,"lastChat",q(a[c].id,"joinTime",Date.now()));$(b[c]).text(plugCubed.S(e,36E5>e?"mm:ss":"hh:mm:ss"))}}S.sio.$events.chat=R.listener.chat=function(a){a.fromID&&t(a.fromID,
"lastChat",Date.now());"undefined"!==typeof plugCubed&&-1<plugCubed.settings.ignore.indexOf(a.fromID)?plugCubed.P(a):!a.chatID||0<$(".chat-id-"+a.chatID).length?a.fromID&&a.fromID===API.getUser().id&&(m.readyState===SockJS.OPEN&&m.send(JSON.stringify({type:"chat",msg:a.message,chatID:a.chatID})),!0!==$(".chat-id-"+a.chatID).data("eventSent")&&(API.dispatch(API.CHAT,a),$(".chat-id-"+a.chatID).data("eventSent",!0))):(k.receive(a),API.dispatch(API.CHAT,a))};var y={},P,z={major:2,minor:1,patch:2,N:"",
L:!0,toString:function(){return this.major+"."+this.minor+"."+this.patch+(void 0!==this.N&&""!==this.N?"-"+this.N:"")+(this.L?"_min":"")}},r=[],Q={},m,F=!1,h={},n={};return p.extend({init:function(){"undefined"===typeof I&&(I={});null!==f.getItem("plugCubedLang")&&"@@@"!==f.getItem("plugCubedLang")&&(this.proxy={menu:$.proxy(this.ba,this),D:$.proxy(this.D,this),F:$.proxy(this.F,this),C:$.proxy(this.C,this),onUserJoin:$.proxy(this.onUserJoin,this),onUserLeave:$.proxy(this.onUserLeave,this),B:$.proxy(this.B,
this),p:$.proxy(this.p,this),onSkip:$.proxy(this.onSkip,this),onRoomJoin:$.proxy(this.onRoomJoin,this)},$.getScript("http://alpha.plugcubed.net/langs/lang."+f.getItem("plugCubedLang")+".js",function(){require(["plugCubed/Lang"],function(a){Q=a;plugCubed.T()})}),"undefined"===typeof jQuery.fn.tabs&&($.getScript("http://code.jquery.com/ui/1.10.2/jquery-ui.js"),$("head").append('<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />')))},d:function(a){var b=
Q,c;if(void 0===b)return"{"+a+"}";a=a.split(".");for(c in a){if(void 0===b[a[c]])return"{"+a.join(".")+"}";b=b[a[c]]}if(1<arguments.length)for(c=1;c<arguments.length;c++)b=b.split("%"+c).join(arguments[c]);return b},T:function(){P=setInterval(V,1E3);this.colors={ha:"66FFFF",fa:"FF0000",I:"FFFF00",ea:"66FFFF"};this.R=this.d("AFK.default");setTimeout(function(){r=[];var a=API.getHistory(),b;for(b in a){var d=a[b];r.push({id:d.media.id,author:d.media.author,title:d.media.title,H:!1,user:{id:d.user.id.toString(),
username:d.user.username}})}},1);this.A=$('<style type="text/css" />');$("head").append(this.A);v(this.d("running",z.toString())+'</span><br /><span class="chat-text" style="color:#66FFFF">'+this.d("commandsHelp"),"FFFF00");console.log("__init");window.addEventListener("pushState",plugCubed.proxy.onRoomJoin);$("body").prepend('<link rel="stylesheet" type="text/css" id="plugcubed-css" href="http://alpha.plugcubed.net/plugCubed.css?='+Date.now()+'" />').prepend('<link rel="stylesheet" type="text/css" id="font-awesome" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css">').append($('<div id="side-left" class="sidebar" />').append($('<div class="sidebar-handle"><span>||</span></div>')).append($('<div class="sidebar-content" />').append($('<div id="lock" class="icon-unlock" />').data("key",
"ulLock").click(this.proxy.menu)))).append($('<div id="side-right" class="sidebar" />').append($('<div class="sidebar-handle"><span>||</span></div>')).append($('<div class="sidebar-content" />').append($('<div id="lock" class="icon-unlock" />').data("key","mLock").click(this.proxy.menu)))).append('<script type="text/javascript" src="http://alpha.plugcubed.net/thirdparty.js?='+Date.now()+'">\x3c/script>');this.X();this.J();this.V();var a=API.getUsers(),b;for(b in a)t(a[b].id,"joinTime",Date.now());
H();this.Socket();this.loaded=!0;K();$("#footer-links").append($("<div />").addClass("footer").addClass("plugcubed-footer").css("top",12).html(this.d("running",z.toString())+this.d("footer.seperator")).append($("<span />").addClass("plugcubed-status").text(this.d("footer.socket",this.d("footer.unknown")))))},onRoomJoin:function(){"undefined"!==typeof plugCubed&&setTimeout(function(){if(API.enabled)$.getScript("http://alpha.plugcubed.net/plugCubed."+(z.L?"min.":"")+"js?="+Date.now());else plugCubed.onRoomJoin()},
500)},close:function(){if(void 0!==this.loaded&&!1!==this.loaded){clearInterval(P);O();E({});window.removeEventListener("pushState",plugCubed.proxy.onRoomJoin);API.off(API.CHAT_COMMAND,this.Q);API.off(API.DJ_ADVANCE,this.proxy.D);API.off(API.VOTE_UPDATE,this.proxy.F);API.off(API.CURATE_UPDATE,this.proxy.C);API.off(API.USER_JOIN,this.proxy.onUserJoin);API.off(API.USER_LEAVE,this.proxy.onUserLeave);API.off(API.CHAT,this.proxy.B);API.off(API.VOTE_SKIP,this.proxy.onSkip);API.off(API.USER_SKIP,this.proxy.onSkip);
API.off(API.MOD_SKIP,this.proxy.onSkip);API.off(API.WAIT_LIST_UPDATE,this.proxy.p);for(var a in y)void 0!==a&&void 0!==y[a]&&($("#plugcubed-btn-"+a).unbind(),delete y[a]);$("#plugcubed-css").remove();$("#font-awesome").remove();$("#plugcubed-js-extra").remove();$("#side-right").remove();$("#side-left").remove();$("#notify-dialog").remove();$(".plugcubed-footer").remove();this.A&&this.A.remove();m&&(m.onclose=function(){console.log("[plug\u00b3 Socket Server]","Closed")},m.close());requirejs.undef("plugCubed/Model");
requirejs.undef("plugCubed/dialog/notify");requirejs.undef("plugCubed/dialog/customChatColors");requirejs.undef("plugCubed/dialog/chatLimit");requirejs.undef("plugCubed/dialog/commands");requirejs.undef("plugCubed/Lang");requirejs.undef("plugCubed/Loader");this.loaded=!1;delete plugCubed}},Socket:function(){if(void 0===m||m.readyState!==SockJS.OPEN)m=new SockJS("http://socket.plugcubed.net/gateway"),m.tries=0,console.log("[plug\u00b3 Socket Server]",this.reconnecting?"Reconnecting":"Connecting"),
m.onopen=function(){this.tries=0;console.log("[plug\u00b3 Socket Server]",this.reconnecting?"Reconnected":"Connected");var a=API.getUser();this.send(JSON.stringify({type:"userdata",id:a.id,username:a.username,room:d.get("id"),version:z.toString()}));$(".plugcubed-status").text(plugCubed.d("footer.socket",plugCubed.d("footer.online")))},m.onmessage=function(a){var b=JSON.parse(a.data);a=b.type;b=b.data;if("update"===a)return this.onclose=function(){},this.close(),API.chatLog(plugCubed.d("newVersion"),
null,plugCubed.colors.I),setTimeout(function(){$.getScript("http://alpha.plugcubed.net/plugCubed."+(z.L?"min.":"")+"js")},5E3);if("chat"===a){if(!b.chatID||0<$(".chat-id-"+b.chatID).length||-1<plugCubed.settings.ignore.indexOf(b.fromID))return;k.receive(b);return API.trigger(API.CHAT,b)}if("rave"===a&&(u(b.id)||C(b.id)||API.hasPermission(b.id,API.ROLE.HOST)))return 2>b.value?s.strobeMode(1===b.value):s.lightsOut(!0)},m.onclose=function(){console.log("[plug\u00b3 Socket Server]","Closed");this.tries++;
this.reconnecting=!0;var a;if(5>this.tries)a=5;else if(30>this.tries)a=30;else if(60>this.tries)a=60;else return;setTimeout(function(){plugCubed.Socket()},1E3*a);$(".plugcubed-status").text(plugCubed.d("footer.socket",plugCubed.d("footer.offline")))}},u:{you:{title:"ranks.you",color:"FFDD6F"},regular:{title:"ranks.regular",color:"B0B0B0"},featureddj:{title:"ranks.featureddj",color:"E90E82"},bouncer:{title:"ranks.bouncer",color:"E90E82"},manager:{title:"ranks.manager",color:"E90E82"},cohost:{title:"ranks.cohost",
color:"E90E82"},host:{title:"ranks.host",color:"E90E82"},ambassador:{title:"ranks.ambassador",color:"9A50FF"},admin:{title:"ranks.admin",color:"42A5DC"},join:{title:"notify.join",color:"3366FF"},leave:{title:"notify.leave",color:"3366FF"},curate:{title:"notify.curate",color:"00FF00"},stats:{title:"notify.stats",color:"66FFFF"},updates:{title:"notify.updates",color:"FFFF00"}},settings:{recent:!1,awaymsg:"",autowoot:!1,autojoin:!1,autorespond:!1,menu:!1,notify:0,customColors:!1,emoji:!0,avatarAnimations:!0,
menuLocked:!0,G:!0,registeredSongs:[],ignore:[],alertson:[],autoMuted:!1,afkTimers:!1,chatlimit:{enabled:!1,limit:50},useRoomSettings:{},colors:{you:"FFDD6F",regular:"B0B0B0",featureddj:"E90E82",bouncer:"E90E82",manager:"E90E82",cohost:"E90E82",host:"E90E82",ambassador:"9A50FF",admin:"42A5DC",join:"3366FF",leave:"3366FF",curate:"00FF00",stats:"66FFFF",updates:"FFFF00"}},X:function(){try{var a=JSON.parse(f.getItem("plugCubed")),b;for(b in this.settings)void 0!==a[b]&&(this.settings[b]=a[b]);this.settings.recent=
!1;$("#side-right .sidebar-content #lock").attr("class","icon-"+(this.settings.menuLocked?"":"un")+"lock");$("#side-left .sidebar-content #lock").attr("class","icon-"+(this.settings.G?"":"un")+"lock");this.settings.afkTimers&&N();this.settings.autowoot&&M();this.settings.customColors&&this.O();0<this.settings.registeredSongs.length&&-1<this.settings.registeredSongs.indexOf(Models.room.data.media.id)&&(API.setVolume(0),this.settings.autoMuted=!0,API.chatLog(this.d("automuted",API.getMedia().title)));
if(void 0===JSON.parse(f.getItem("stngs")).emoji){var c=JSON.parse(f.getItem("stngs"));c.emoji=!0;f.setItem("stngs",JSON.stringify(c),!0)}}catch(e){}},saveSettings:function(){f.setItem("plugCubed",JSON.stringify(this.settings))},O:function(){var a=[],b=this.settings.useRoomSettings[window.location.pathname.split("/")[1]];((b=void 0===b||!0===b?!0:!1)&&h.regular||this.settings.customColors)&&a.push(".chat-message .chat-from,",".chat-mention .chat-from { color:#"+(h.regular?h.regular:this.settings.colors.regular)+
"!important; }");(b&&h.featureddj||this.settings.customColors)&&a.push(".chat-message .chat-from-featureddj,",".chat-mention .chat-from-featureddj { color:#"+(h.featureddj?h.featureddj:this.settings.colors.featureddj)+"!important; }");(b&&h.bouncer||this.settings.customColors)&&a.push(".chat-message .chat-from-bouncer,",".chat-mention .chat-from-bouncer { color:#"+(h.bouncer?h.bouncer:this.settings.colors.bouncer)+"!important; }");(b&&h.manager||this.settings.customColors)&&a.push(".chat-message .chat-from-manager,",
".chat-mention .chat-from-manager { color:#"+(h.manager?h.manager:this.settings.colors.manager)+"!important; }");(b&&h.cohost||this.settings.customColors)&&a.push(".chat-message .chat-from-cohost,",".chat-mention .chat-from-cohost { color:#"+(h.cohost?h.cohost:this.settings.colors.cohost)+"!important; }");(b&&h.host||this.settings.customColors)&&a.push(".chat-message .chat-from-host,",".chat-mention .chat-from-host { color:#"+(h.host?h.host:this.settings.colors.host)+"!important; }");(b&&h.ambassador||
this.settings.customColors)&&a.push(".chat-message .chat-from-ambassador,",".chat-mention .chat-from-ambassador { color:#"+(h.ambassador?h.ambassador:this.settings.colors.ambassador)+"!important; }");(b&&h.admin||this.settings.customColors)&&a.push(".chat-message .chat-from-admin,",".chat-mention .chat-from-admin { color:#"+(h.admin?h.admin:this.settings.colors.admin)+"!important; }");(b&&h.you||this.settings.customColors)&&a.push(".chat-message .chat-from-you,",".chat-mention .chat-from-you { color:#"+
(h.you?h.you:this.settings.colors.you)+"!important; }");b&&(n.admin&&a.push('.chat-admin { background-image: url("'+n.admin+'"); }'),n.ambassador&&a.push('.chat-ambassador { background-image: url("'+n.ambassador+'"); }'),n.bouncer&&a.push('.chat-bouncer { background-image: url("'+n.bouncer+'"); }'),n.cohost&&a.push('.chat-cohost { background-image: url("'+n.cohost+'"); }'),n.U&&a.push('.chat-featureddj { background-image: url("'+n.U+'"); }'),n.host&&a.push('.chat-host { background-image: url("'+n.host+
'"); }'),n.manager&&a.push('.chat-manager { background-image: url("'+n.manager+'"); }'));this.A.text(a.join("\n"))},V:function(){API.on(API.CHAT_COMMAND,this.Q);API.on(API.DJ_ADVANCE,this.proxy.D);API.on(API.VOTE_UPDATE,this.proxy.F);API.on(API.CURATE_UPDATE,this.proxy.C);API.on(API.USER_JOIN,this.proxy.onUserJoin);API.on(API.USER_LEAVE,this.proxy.onUserLeave);API.on(API.CHAT,this.proxy.B);API.on(API.VOTE_SKIP,this.proxy.onSkip);API.on(API.USER_SKIP,this.proxy.onSkip);API.on(API.MOD_SKIP,this.proxy.onSkip);
API.on(API.WAIT_LIST_UPDATE,this.proxy.p)},J:function(){y={};$("#side-right .sidebar-content .plugcubed-btn, #side-right .sidebar-content hr").remove();this.k(this.settings.autowoot,"woot",this.d("menu.autowoot"),"heart");this.k(this.settings.autojoin,"join",this.d("menu.autojoin"));this.k(this.settings.customColors,"colors",this.d("menu.customchatcolors"),"tint");this.k(this.settings.autorespond,"autorespond",this.d("menu.afkstatus"),"reply");this.k(1===(this.settings.notify&1),"notify",this.d("menu.notify"),
"warning-sign");this.k(this.settings.chatlimit.enabled,"chatlimit",this.d("menu.limitchatlog"),"ban-circle");this.k(!JSON.parse(f.getItem("stngs")).streamDisabled,"stream",this.d("menu.stream"),"facetime-video");this.k(JSON.parse(f.getItem("stngs")).emoji,"emoji",this.d("menu.emoji"),"smile");API.hasPermission(void 0,API.ROLE.BOUNCER)&&this.k(this.settings.afkTimers,"afktimers",this.d("menu.afktimers"),"time");if(F){var a=this.settings.useRoomSettings[window.location.pathname.split("/")[1]];this.k(void 0!==
a?a:!0,"roomsettings",this.d("menu.roomsettings"),"beaker")}},k:function(a,b,c,e){void 0===y[b]&&(0<$("#side-right .sidebar-content .plugcubed-btn").length&&$("#side-right .sidebar-content").append("<hr />"),$("#side-right .sidebar-content").append('<a id="plugcubed-btn-'+b+'" class="plugcubed-btn"><div class="status-'+(a?"on":"off")+" icon-"+(e?e:"circle")+'"></div>'+c+"</a>"),$("#plugcubed-btn-"+b).data("key",b).click(this.proxy.menu),y[b]={text:c})},f:function(a,b){$("#plugcubed-btn-"+a).find('[class^="status-"], [class*=" status-"]').removeClass("status-on").removeClass("status-off").addClass("status-"+
(!0===b?"on":"off"))},M:function(a,b){if(API.hasPermission(void 0,API.ROLE.BOUNCER)){var c;switch(b){case "kick":c=API.moderateKickUser;break;case "removedj":c=API.moderateRemoveDJ;break;case "adddj":c=API.moderateAddDJ;break;default:API.chatLog(this.d("error.unknownModeration"));return}var e=A(a);null===e?API.chatLog(this.d("error.userNotFound")):c(e.id," ")}},ba:function(a){var b=$(a.currentTarget).data("key");switch(b){case "ulLock":this.settings.G=!this.settings.G;$(a.currentTarget).attr("class",
"icon-"+(this.settings.G?"":"un")+"lock");break;case "mLock":this.settings.menuLocked=!this.settings.menuLocked;$(a.currentTarget).attr("class","icon-"+(this.settings.menuLocked?"":"un")+"lock");break;case "woot":this.settings.autowoot=!this.settings.autowoot;this.f("woot",this.settings.autowoot);this.settings.autowoot&&$("#button-vote-positive").click();break;case "join":this.settings.autojoin=!this.settings.autojoin;this.f("join",this.settings.autojoin);this.settings.autojoin&&0<$("#button-dj-waitlist-join").length&&
!1===d.get("boothLocked")&&API.djJoin();break;case "userlist":this.settings.userlist=!this.settings.userlist;this.f("userlist",this.settings.userlist);this.settings.userlist?(H(),showUserlist()):($("#side-left .sidebar-content").empty(),hideUserlist());break;case "colors":require(["plugCubed/dialog/customChatColors","app/base/Context","app/events/ShowDialogEvent"],function(a,b,d){b.dispatch(new d(d.SHOW,new a))});break;case "autorespond":this.settings.autorespond=!this.settings.autorespond;this.f("autorespond",
this.settings.autorespond);if(this.settings.autorespond){b=prompt(this.d("AFK.information"),""===this.settings.awaymsg?this.R:this.settings.awaymsg);if(null===b){this.settings.autorespond=!1;this.f("autorespond",!1);return}b=b.split("@").join("").trim();this.settings.awaymsg=""===b?this.R:b;0>=API.getUser().status&&API.setStatus(API.STATUS.AFK)}else API.setStatus(API.STATUS.AVAILABLE);break;case "notify":require(["plugCubed/dialog/notify","app/base/Context","app/events/ShowDialogEvent"],function(a,
b,d){b.dispatch(new d(d.SHOW,new a))});break;case "chatlimit":require(["plugCubed/dialog/chatLimit","app/base/Context","app/events/ShowDialogEvent"],function(a,b,d){b.dispatch(new d(d.SHOW,new a))});break;case "stream":return b=JSON.parse(f.getItem("stngs")).streamDisabled,this.f("stream",b),API.sendChat(b?"/stream on":"/stream off");case "emoji":return b=!1===JSON.parse(f.getItem("stngs")).emoji,this.f("emoji",b),API.sendChat(b?"/emoji on":"/emoji off");case "roomsettings":b=this.settings.useRoomSettings[window.location.pathname.split("/")[1]];
b=void 0===b||!0===b?!1:!0;this.settings.useRoomSettings[window.location.pathname.split("/")[1]]=b;(b?K:E)({});this.f("roomsettings",b);break;case "afktimers":this.settings.afkTimers=!this.settings.afkTimers;this.f("afktimers",this.settings.afkTimers);(this.settings.afkTimers?N:O)();break;default:return API.chatLog(this.d("menu.unknownMenuKey"))}this.saveSettings()},ga:function(){for(var a in this.settings.colors){var b=$('input[name="'+a+'"]');b.val(b.data("ph"));b.parents(".dialog-input-container").find(".dialog-input-label").css("color",
"#"+b.val())}},F:function(a){if(a&&a.user){var b=q(a.user.id,"curVote",0);1===b?t(a.user.id,"wootcount",q(a.user.id,"wootcount",0)-1):-1===b&&t(a.user.id,"mehcount",q(a.user.id,"mehcount",0)-1);1===a.vote?t(a.user.id,"wootcount",q(a.user.id,"wootcount",0)+1):-1===a.vote&&t(a.user.id,"mehcount",q(a.user.id,"mehcount",0)+1);t(a.user.id,"curVote",a.vote);this.p()}},C:function(a){var b=API.getMedia();9===(this.settings.notify&9)&&v(this.d("notify.message.curate",g.cleanTypedString(a.user.username),b.author,
b.title),this.settings.colors.curate);this.p()},D:function(a){17===(this.settings.notify&17)&&v(this.d("notify.message.stats",a.lastPlay.score.positive,a.lastPlay.score.negative,a.lastPlay.score.curates),this.settings.colors.stats);33===(this.settings.notify&33)&&v(this.d("notify.message.updates",a.media.title,a.media.author,g.cleanTypedString(a.dj.username)),this.settings.colors.updates);setTimeout($.proxy(this.Y,this),1E3*Math.ca());this.Z(a.media.id);50<r.unshift({id:a.media.id,author:a.media.author,
title:a.media.title,H:!1,user:{id:a.dj.id,username:a.dj.username}})&&r.splice(50,r.length-50);this.settings.autoMuted&&0>this.settings.registeredSongs.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(plugCubed.lastVolume)},800),this.settings.autoMuted=!1);!this.settings.autoMuted&&-1<this.settings.registeredSongs.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(0)},800),this.settings.autoMuted=!0,this.lastVolume=API.getVolume(),API.chatLog(i18n("automuted",a.media.title)));this.p();
a=API.getUsers();for(var b in a)t(a[b].id,"curVote",0)},Y:function(){this.settings.autowoot&&0>this.settings.registeredSongs.indexOf(API.getHistory()[0].media.id)&&M();this.settings.autojoin&&!0!==d.get("boothLocked")&&("block"!==$("#button-dj-play").css("display")&&"block"!==$("#button-dj-waitlist-join").css("display")||API.djJoin())},onUserJoin:function(a){3===(this.settings.notify&3)&&void 0!==d.getUserByID(a.id)&&1>d.getUserByID(a.id).get("relationship")&&v(this.d("notify.message.join",g.cleanTypedString(a.username)),
this.settings.colors.join);0===q(a.id,"joinTime",0)&&t(a.id,"joinTime",Date.now());this.p()},onUserLeave:function(a){5===(this.settings.notify&5)&&v(this.d(0===a.relationship?"notify.message.leave.normal":1<a.relationship?"notify.message.leave.friend":"notify.message.leave.fan",g.cleanTypedString(a.username)),this.settings.colors.leave);t(a.id,"disconnects",q(a.id,"disconnects",0)+1);t(a.id,"lastDisconnect",Date.now());this.p()},P:function(a){var b="mention"==a.type&&API.hasPermission(a.fromID,API.ROLE.BOUNCER),
c=0>a.message.indexOf("@")&&(API.hasPermission(a.fromID,API.ROLE.HOST)||u(a.fromID));if(b||c)-1<a.message.indexOf("!disable")&&(this.settings.autojoin?(this.settings.autojoin=!1,this.f("join",this.settings.autojoin),this.saveSettings(),API.sendChat("@"+a.from+" Autojoin disabled")):API.sendChat("@"+a.from+" Autojoin was not enabled")),-1<a.message.indexOf("!afkdisable")&&(this.settings.autorespond?(this.settings.autorespond=!1,this.f("autorespond",this.settings.autorespond),this.saveSettings(),API.sendChat("@"+
a.from+" AFK message disabled")):API.sendChat("@"+a.from+" AFK message was not enabled")),0<a.message.indexOf("!disable")||a.message.indexOf("!afkdisable")},B:function(a){this.P(a);if("mention"==a.type)this.settings.autorespond&&!this.settings.recent&&(this.settings.recent=!0,setTimeout(function(){plugCubed.settings.recent=!1;plugCubed.saveSettings()},18E4),API.sendChat("@"+a.from+" "+this.settings.awaymsg));else for(var b in this.settings.alertson)-1<a.message.indexOf(this.settings.alertson[b])&&
G();if(this.settings.chatlimit.enabled){a=$("#chat-messages").children("div");var c=a.length;b=0;a.each(function(){++b;var a=c-plugCubed.settings.chatlimit.limit-1;b<a?$(this).remove():b==a&&0==b%2&&$(this).remove()})}},p:function(){H()},onSkip:function(){r[1].H=!0},Z:function(a){if(API.hasPermission(void 0,API.ROLE.BOUNCER)||u()||65===(plugCubed.settings.notify&65)){var b=-1,c;for(c in r){var e=r[c];if(e.id==a&&~~c+1<r.length&&(b=~~c+2,!e.H))return G(),setTimeout(function(){G()},50),API.chatLog(this.d("historyCheck.inHistory",
b,r.length),!0)}if(0<b)return API.chatLog(this.d("historyCheck.inHistorySkipped",b,r.length),!0)}},S:function(a,b){b||(b="hh:mm");var c=a?new Date(a):new Date,e=c.getHours(),d=c.getMinutes(),c=c.getSeconds(),d=(10>d?"0":"")+d,c=(10>c?"0":"")+c;return b.split("hh").join((10>e?"0":"")+e).split("mm").join(d).split("ss").join(c)},Q:function(a){if(0===a.indexOf("/commands"))return require(["plugCubed/dialog/commands","app/base/Context","app/events/ShowDialogEvent"],function(a,b,c){b.dispatch(new c(c.SHOW,
new a))}),!0;if("/avail"==a||"/available"==a)return API.setStatus(0);if("/brb"==a||"/away"==a)API.setStatus(1),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=!1,plugCubed.f("join",!1),plugCubed.saveSettings());else{if("/work"==a||"/working"==a)return API.setStatus(2);if("/sleep"==a||"/sleeping"==a)return plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=!1,plugCubed.f("join",!1),plugCubed.saveSettings()),API.setStatus(3);if("/join"==a)return API.djJoin();if("/leave"==a)return API.djLeave();
if("/whoami"==a)return B(API.getUser().id);if("/refresh"==a)return $("#button-refresh").click();if("/version"==a)return API.chatLog(plugCubed.d("running",z.toString()));if("/mute"==a){if(0===API.getVolume())return;plugCubed.lastVolume=API.getVolume();return API.setVolume(0)}if("/link"==a)return API.sendChat("plugCubed : http://plugcubed.com");if("/unmute"==a)return 0<API.getVolume()?API.setVolume(plugCubed.lastVolume):!0;if("/nextsong"==a){var b=API.getNextMedia(),c=-1;if(void 0===b)return API.chatLog(plugCubed.d("noNextSong"));
var b=b.media,e;for(e in r)if(a=r[e],a.id==b.id&&(c=~~e+1,!a.H))return API.chatLog(plugCubed.d("nextsong",b.title,b.author)),API.chatLog(plugCubed.d("isHistory",c,r.length),!0);return API.chatLog(plugCubed.d("nextsong",b.title,b.author))}if("/automute"==a){a=API.getMedia();if(void 0===a)return;0>plugCubed.settings.registeredSongs.indexOf(a.id)?(plugCubed.settings.registeredSongs.push(a.id),plugCubed.settings.autoMuted=!0,plugCubed.lastVolume=API.getVolume(),API.setVolume(0),API.chatLog(plugCubed.d("automute.registered",
a.title))):(plugCubed.settings.registeredSongs.splice(plugCubed.settings.registeredSongs.indexOf(API.getMedia().id),1),plugCubed.settings.autoMuted=!1,API.setVolume(plugCubed.lastVolume),API.chatLog(plugCubed.d("automute.unregistered",a.title)));return plugCubed.saveSettings()}if("/alertsoff"==a)1===(plugCubed.settings.notify&1)&&(v(plugCubed.d("notify.message.disabled"),plugCubed.colors.I),plugCubed.settings.notify--,plugCubed.f("notify",!1));else if("/alertson"==a)1!==(plugCubed.settings.notify&
1)&&(v(plugCubed.d("notify.message.enabled"),plugCubed.colors.I),plugCubed.settings.notify++,plugCubed.f("notify",!0));else if(0===a.indexOf("/getpos")){e=A(a.substr(8));e=null===e?API.getUser():e;a=API.getWaitListPosition(e.id);if(-1!=a)return API.chatLog(plugCubed.d("info.inwaitlist",a,API.getWaitList.length));a=API.getBoothPosition(e.id);0>a?API.chatLog(plugCubed.d("info.notinlist")):0===a?API.chatLog(plugCubed.d("info.userDjing",e.id===API.getUser().id?plugCubed.d("ranks.you"):g.cleanTypedString(e.username))):
1===a?API.chatLog(plugCubed.d("info.userNextDJ",e.id===API.getUser().id?plugCubed.d("ranks.you"):g.cleanTypedString(e.username))):API.chatLog(plugCubed.d("info.inbooth",a+1,API.getDJs().length))}else if("/curate"==a)for(b in a=JSON.parse(f.getItem("playlist")),a){if(a[b].selected)return x.dispatch(new J(J.CURATE,a[b].id)),!0}else{if(0===a.indexOf("/ignore ")||0===a.indexOf("/unignore "))return e=A(a.substr(0===a.indexOf("/ignore")?8:10)),null===e?(API.chatLog(plugCubed.d("error.userNotFound")),!0):
e.id===API.getUser().id?(API.chatLog(plugCubed.d("error.ignoreSelf")),!0):-1<plugCubed.settings.ignore.indexOf(e.id)?(plugCubed.settings.ignore.splice(plugCubed.settings.ignore.indexOf(e.id),1),plugCubed.saveSettings(),API.chatLog(plugCubed.d("ignore.disabled",e.username)),!0):(plugCubed.settings.ignore.push(e.id),plugCubed.saveSettings(),API.chatLog(plugCubed.d("ignore.enabled",g.cleanTypedString(e.username))));if(u()&&0===a.indexOf("/whois "))return"/whois all"===a.toLowerCase()?L():B(a.substr(7));
if(API.hasPermission(void 0,API.ROLE.AMBASSADOR)||u()&&API.hasPermission(void 0,API.ROLE.MANAGER)){if(0===a.indexOf("/whois "))return"/whois all"===a.toLowerCase()?L():B(a.substr(7));if(0===a.indexOf("/kickall")){if(9<a.length)for(e in b=API.getUser(),c=API.getUsers(),c)c[e].id!==b.id&&API.moderateKickUser(c[e].id,a.substr(9).trim());else API.chatLog(plugCubed.d("error.missingReason"));return}if(0===a.indexOf("/banall")){if(9<a.length)for(e in b=API.getUser(),c=API.getUsers(),c)c[e].id!==b.id&&API.moderateBanUser(c[e].id,
a.substr(9).trim());else API.chatLog(plugCubed.d("error.missingReason"));return}}if(API.hasPermission(void 0,API.ROLE.BOUNCER)){if(0===a.indexOf("/skip")){if(1>API.getDJs().length)return;if(0===API.getBoothPosition())return $("#button-skip-this").click();5<a.length&&API.sendChat("@"+API.getDJs()[0].username+" - Reason for skip: "+a.substr(5).trim());return API.moderateForceSkip()}if(0===a.indexOf("/whois "))return B(a.substr(7));if(0===a.indexOf("/kick ")){if(0>a.indexOf("::"))return plugCubed.M(a.substr(6),
"kick");a=a.substr(6).split(":: ");e=A(a[0]);return API.moderateKickUser(e.id,a[1])}if(0===a.indexOf("/add "))return plugCubed.M(a.substr(5),"adddj");if(0===a.indexOf("/remove "))return plugCubed.M(a.substr(8),"removedj")}if(API.hasPermission(void 0,API.ROLE.MANAGER)){if("/lock"===a)return API.moderateRoomProps(!0,d.get("waitListEnabled"));if("/unlock"===a)return API.moderateRoomProps(!1,d.get("waitListEnabled"));"/lockskip"===a&&require(["app/services/room/RoomPropsService"],function(a){d.get("boothLocked")?
(API.once(API.DJ_ADVANCE,function(){(new a(d.get("id"),!1,d.get("waitListEnabled"))).parse=function(a){0!==a.status&&API.chatLog("Could not unlock booth",!0)}}),API.moderateForceSkip()):(new a(d.get("id"),!0,d.get("waitListEnabled"))).parse=function(b){0===b.status?(API.once(API.DJ_ADVANCE,function(){(new a(d.get("id"),!1,d.get("waitListEnabled"))).parse=function(a){0!==a.status&&API.chatLog("Could not unlock booth",!0)}}),API.moderateForceSkip()):API.chatLog("Could not lock booth",!0)}})}if(API.hasPermission(void 0,
API.ROLE.HOST)||u()){if(0===a.indexOf("/strobe")){if(m.readyState!==SockJS.OPEN)return API.chatLog("Not connected to socket server",!0);-1<a.indexOf("off")?m.send(JSON.stringify({type:"rave",value:0})):m.send(JSON.stringify({type:"rave",value:1}))}if(0===a.indexOf("/rave")){if(m.readyState!==SockJS.OPEN)return API.chatLog("Not connected to socket server",!0);-1<a.indexOf("off")?m.send(JSON.stringify({type:"rave",value:0})):m.send(JSON.stringify({type:"rave",value:2}))}}}}}})});
define("plugCubed/dialog/notify",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(l,p){return l.extend({id:"dialog-notify",className:"dialog",render:function(){return this.$el.append(this.getHeader(plugCubed.d("notify.header"))).append(this.getBody().append('<table style="width: 100%;"><tr><td>'+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(1===(plugCubed.settings.notify&1)?' checked="checked"':"")+' value="1" /></td></tr><tr><td>'+plugCubed.d("notify.join")+
'</td><td align="right"><input type="checkbox" name="join"'+(2===(plugCubed.settings.notify&2)?' checked="checked"':"")+' value="2" /></td></tr><tr><td>'+plugCubed.d("notify.leave")+'</td><td align="right"><input type="checkbox" name="leave"'+(4===(plugCubed.settings.notify&4)?' checked="checked"':"")+' value="4" /></td></tr><tr><td>'+plugCubed.d("notify.curate")+'</td><td align="right"><input type="checkbox" name="curate"'+(8===(plugCubed.settings.notify&8)?' checked="checked"':"")+' value="8" /></td></tr><tr><td>'+
plugCubed.d("notify.stats")+'</td><td align="right"><input type="checkbox" name="songStats"'+(16===(plugCubed.settings.notify&16)?' checked="checked"':"")+' value="16" /></td></tr><tr><td>'+plugCubed.d("notify.updates")+'</td><td align="right"><input type="checkbox" name="songUpdate"'+(32===(plugCubed.settings.notify&32)?' checked="checked"':"")+' value="32" /></td></tr>'+(API.hasPermission(void 0,API.ROLE.BOUNCER)?"<tr><td>"+plugCubed.d("notify.history")+'</td><td align="right"><input type="checkbox" name="history"'+
(64===(plugCubed.settings.notify&64)?' checked="checked"':"")+' value="64" /></td></tr>':"")+"</table>")).append(this.getSubmitButton(p.dialog.ok)),this._super()},submit:function(){plugCubed.settings.notify=0;this.$el.find(":checked").each(function(){plugCubed.settings.notify+=~~$(this).val()});plugCubed.saveSettings();plugCubed.f("notify",1===(plugCubed.settings.notify&1));this.close()}})});
define("plugCubed/dialog/customChatColors",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(l,p){return l.extend({id:"dialog-custom-colors",className:"dialog",render:function(){var k=$('<table style="width:100%;padding:5px"/>');k.append("<tr><td>"+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(plugCubed.settings.customColors?' checked="checked"':"")+" /></td></tr>");for(var f in plugCubed.u)k.append($("<tr/>").append('<td style="color:#'+plugCubed.settings.colors[f]+
'"><span><strong>'+plugCubed.d(plugCubed.u[f].title)+"</strong></span></td>").append($('<td align="right"></td>').append($('<input type="text" name="'+f+'" value="'+plugCubed.settings.colors[f]+'" placeholder="'+plugCubed.u[f].color+'" />').data("default",plugCubed.u[f].color).css("width","60px").change(function(){$(this).closest("tr").find("span").css("color","#"+$(this).val())}))));return this.$el.append(this.getHeader(plugCubed.d("menu.customchatcolors"))).append(this.getBody().append(k)).append($("<div/>").addClass("dialog-button dialog-default-button").click(function(){$(this).parent().find('input[type="text"]').each(function(){var g=
$(this);g.val(g.data("default"));g.closest("tr").find("span").css("color","#"+g.val())})}).append($("<span/>").text("Default"))).append(this.getCancelButton()).append(this.getSubmitButton(p.dialog.ok)),this._super()},submit:function(){plugCubed.settings.customColors=this.$el.find('input[name="enabled"]').is(":checked");for(var k in plugCubed.settings.colors){var f=this.$el.find('input[name="'+k+'"]');plugCubed.settings.colors[k]=""!==f.val()&&w(f.val())?f.val():f.data("default")}plugCubed.f("colors",
plugCubed.settings.customColors);plugCubed.saveSettings();plugCubed.O();this.close()}})});
define("plugCubed/dialog/chatLimit",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(l,p){return l.extend({id:"dialog-chat-limit",className:"dialog",render:function(){return this.$el.append(this.getHeader(plugCubed.d("menu.limitchatlog"))).append(this.getBody().append('<table style="width: 100%;"><tr><td>'+plugCubed.d("enable")+'</td><td align="right"><input type="checkbox" name="enabled"'+(plugCubed.settings.chatlimit.enabled?' checked="checked"':"")+" /></td></tr><tr><td>"+plugCubed.d("limit")+
'</td><td align="right"><input type="text" name="limit" value="'+plugCubed.settings.chatlimit.limit+'" /></td></tr></table>')).append(this.getSubmitButton(p.dialog.ok)),this._super()},submit:function(){var k=this.$el.find('input[name="enabled"]').is(":checked"),f=~~this.$el.find('input[name="limit"]').val();1>f&&(f=1);1024<f&&(k=!1,f=1024);plugCubed.settings.chatlimit.enabled=k;plugCubed.settings.chatlimit.limit=f;plugCubed.f("chatlimit",k);plugCubed.saveSettings();if(k){var k=$("#chat-messages").children("div"),
g=k.length,d=0;k.each(function(){++d<g-f&&$(this).remove()})}this.close()}})});
define("plugCubed/dialog/userinfo",["app/views/dialogs/AbstractDialogView","lang/Lang","app/base/Class","app/base/Context","app/events/ShowDialogEvent"],function(l,p,k,f,g){return k.extend({init:function(){f.dispatch(new g(g.SHOW,new l.extend({id:"dialog-commands",className:"dialog",render:function(){var d="<table>",g;for(g in userCommands)d+="<tr><td>"+userCommands[g][0]+"</td><td>"+userCommands[g][1]+"</td></tr>";d+="</table>";if(API.hasPermission(void 0,API.ROLE.BOUNCER)){d='<div id="plugCubedCommands"><ul><li><a href="#user">'+
plugCubed.d("commands.userCommands")+'</a></li><li><a href="#mod">'+plugCubed.d("commands.modCommands")+'</a></li></ul><div id="user">'+d+'</div><div id="mod"><table>';for(g in modCommands)API.hasPermission(void 0,modCommands[g][2])&&(d+="<tr><td>"+modCommands[g][0]+"</td><td>"+modCommands[g][1]+"</td></tr>");d=$(d+"</table></div></div>").tabs()}return this.$el.append(this.getHeader(plugCubed.d("info.header"))).append(this.getBody().append(d)),this._super()},submit:function(){this.close()}})))}})});
define("plugCubed/dialog/commands",["app/views/dialogs/AbstractDialogView","lang/Lang"],function(l,p){var k=[["/nick","change username"],["/avail","set status to available"],["/afk","set status to afk"],["/work","set status to working"],["/sleep","set status to sleeping"],["/join","join dj booth/waitlist"],["/leave","leaves dj booth/waitlist"],["/whoami","get your own information"],["/mute","set volume to 0"],["/automute","register currently playing song to automatically mute on future plays"],["/unmute",
"set volume to last volume"],["/nextsong","display next song in playlist and if it's in history"],["/refresh","refresh the video"],["/ignore (username)","ignore all chat messages from user"],["/alertson (word)","play mention sound whenever word is written in chat"],["/curate","add current song to your selected playlist"],["/getpos","get current waitlist position"],["/version","displays version number"],["/commands","shows this list"],["/link","paste link to plugCubed website in chat"]],f=[["/whois (username)",
"gives general information about user",API.ROLE.BOUNCER],["/skip","skip current song",API.ROLE.BOUNCER],["/kick (username)","kicks targeted user",API.ROLE.BOUNCER],["/lockskip","locks DJ booth, skip and unlocks afterwards",API.ROLE.MANAGER],["/lock","locks DJ booth",API.ROLE.MANAGER],["/unlock","unlocks DJ booth",API.ROLE.MANAGER],["/add (username)","adds targeted user to dj booth/waitlist",API.ROLE.BOUNCER],["/remove (username)","removes targeted user from dj booth/waitlist",API.ROLE.BOUNCER],["/strobe (on|off)",
"enable/disable strobe",API.ROLE.HOST],["/rave (on|off)","enable/disable lights out",API.ROLE.HOST],["/whois all","gives userid and username of all users in the room",API.ROLE.AMBASSADOR],["/kickall (reason)","kicks all users in the room with reason",API.ROLE.AMBASSADOR],["/banall (reason)","bans all users in the room with reason",API.ROLE.AMBASSADOR]];return l.extend({id:"dialog-commands",className:"dialog",render:function(){var g="<table>",d;for(d in k)g+="<tr><td>"+k[d][0]+"</td><td>"+k[d][1]+
"</td></tr>";g+="</table>";if(API.hasPermission(void 0,API.ROLE.BOUNCER)){g='<div id="plugCubedCommands"><ul><li><a href="#user">'+plugCubed.d("commands.userCommands")+'</a></li><li><a href="#mod">'+plugCubed.d("commands.modCommands")+'</a></li></ul><div id="user">'+g+'</div><div id="mod"><table>';for(d in f)API.hasPermission(void 0,f[d][2])&&(g+="<tr><td>"+f[d][0]+"</td><td>"+f[d][1]+"</td></tr>");g=$(g+"</table></div></div>").tabs()}return this.$el.append(this.getHeader(plugCubed.d("commands.header"))).append(this.getBody().append(g)).append(this.getSubmitButton(p.dialog.ok)),
this._super()},submit:function(){this.close()}})});
define("plugCubed/Loader",["app/base/Class","plugCubed/Model","app/store/LocalStorage"],function(l,p,k){var f=k.getItem("plugCubedLang");return null!==f&&"@@@"!==f?l.extend({init:function(){plugCubed=new p}}):l.extend({init:function(){$("#overlay-container").append($("#avatar-overlay").clone(!1,!1).attr("id","plugCubedLang-overlay").width(800).height(600).css("position","absolute"));$("#plugCubedLang-overlay").find(".overlay-title").html("plug&#179; language");$("#plugCubedLang-overlay").find("#avatar-sets").remove();
$("#plugCubedLang-overlay").find("#avatar-panel").attr("id","plugCubedLang-panel").css("padding-top","60px");$("#plugCubedLang-overlay").find(".overlay-close-button").click($.proxy(this.hide,this));this.W()},show:function(){$("#user-list-overlay").hide();$("#lobby-overlay").hide();$("#media-overlay").hide();$("#avatar-overlay").hide();$("#plugCubedLang-overlay").show();$("#overlay-container").show();this.draw()},hide:function(){$("#user-list-overlay").hide();$("#lobby-overlay").hide();$("#media-overlay").hide();
$("#avatar-overlay").hide();$("#plugCubedLang-overlay").hide();$("#overlay-container").hide()},draw:function(){$("#plugCubedLang-panel").html("").scrollTop(0);var g=this.q.length,d=$("<div/>");if(5<g)for(var f=0;f<g/5;f++)d.append(this.drawRow(this.q.slice(5*f,5*f+5)).css("top",75*f));else d.append(this.drawRow(this.q).css("top",75*f));$("#plugCubedLang-panel").append(d);$(".lang-button").click($.proxy(this.aa,this))},drawRow:function(g){for(var d=$("<div/>").addClass("lang-row"),f=g.length,k=5==
f?0:4==f?75:3==f?150:2==f?225:300,l=0;l<f;++l){var p=$("<div/>").addClass("lang-button").css("display","inline-block").css("left",k).data("language",g[l].file).css("cursor","pointer").append($("<img/>").attr("src","http://alpha.plugcubed.net/flags/flag."+g[l].file+".png").attr("alt",g[l].name).height(75).width(150));d.append(p);k+=150}return d},aa:function(f){f=$(f.currentTarget);k.setItem("plugCubedLang",f.data("language"),!0);plugCubed=new p;this.hide()},W:function(){var f=this;this.q=[];$.getJSON("http://alpha.plugcubed.net/lang.json",
function(d){f.q=d;f.show()}).done(function(){0===f.q.length&&log('<span style="color:#FF0000">Error loading plugCubed</span>')})}})});require(["plugCubed/Loader"],function(l){new l});
//# sourceMappingURL=http://tatdk.github.io/plugCubed/compiled/plugCubed.min.js.map 
