/*
 Copyright (c) 2012-2013 by Jeremy "Colgate" Richardson and Thomas "TAT" Andresen

 Permission to use and/or distribute this software or parts of it for any purpose without
 fee is hereby granted, provided that the above copyright notice and this permission notice
 appear in all copies.

 Permission to copy and/or edit this software or parts of it for any purpose is NOT permitted
 without written permission by the authors.

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHORS DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHORS
 BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER
 RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

 @author  Jeremy "Colgate" Richardson
 @author  Thomas "TAT" Andresen
*/
var e=void 0,g=!0,h=null,k=!1;plugCubed!==e&&plugCubed.close();function m(b){a="#"!==b.substr(0,1)?"#"+b:b;return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)}Math.Da=function(){return 1+Math.floor(10*Math.random())};
var plugCubed=new (Class.extend({F:{},K:function(){return"undefined"!==typeof pdpSocket&&"http://socket.plugpony.net:9000/gateway"===pdpSocket._base_url},version:{major:1,minor:5,ka:4},init:function(){"undefined"===typeof jQuery.fn.tabs&&($.getScript("http://code.jquery.com/ui/1.10.2/jquery-ui.js"),$("head").append('<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />'));this.ja=k;this.proxy={menu:{V:$.proxy(this.V,this),U:$.proxy(this.U,this),Z:$.proxy(this.Z,
this),T:$.proxy(this.T,this),X:$.proxy(this.X,this),Y:$.proxy(this.Y,this),W:$.proxy(this.W,this)},O:$.proxy(this.O,this),onVoteUpdate:$.proxy(this.onVoteUpdate,this),N:$.proxy(this.N,this),P:$.proxy(this.P,this),Q:$.proxy(this.Q,this),M:$.proxy(this.M,this),i:$.proxy(this.i,this),G:$.proxy(this.G,this)};this.colors={Fa:"#66FFFF",Ea:"#FF0000",u:"#FFFF00",f:"#66FFFF"};this.ga="I'm away from keyboard.";this.history=[];this.qa();this.J=$('<style type="text/css"></css>');$("head").append(this.J);this.log("Running plug&#179; version "+
this.version.major+"."+this.version.minor+"."+this.version.ka,h,this.colors.u);this.log("Use '/commands' to see expanded chat commands.",h,this.colors.f);Dialog.ma=function(b,c){this.closeDialog();var d=b;c!==e&&(d='<div id="plugCubedCommands"><ul><li><a href="#user">User Commands</a></li><li><a href="#mod">Moderation Commands</a></li></ul><div id="user">'+b+'</div><div id="mod">'+c+"</div></div>");this.showDialog($("<div/>").attr("id","dialog-alert").addClass("dialog").css("left",Main.LEFT+(Main.WIDTH-
620-15)/2).css("top",200).width(645).height(470).append(this.getHeader("plug&#179; Commands")).append($("<div/>").addClass("dialog-body").append(this.getMessage(d).width(620))));$("#plugCubedCommands").tabs()};Models.chat.B===e&&(Models.chat.B=Models.chat.chatCommand);ChatModel.B===e&&(ChatModel.B=ChatModel.chatCommand);Models.chat.chatCommand=this.fa;ChatModel.chatCommand=this.fa;this.wa();$("body").prepend('<style type="text/css" id="plugcubed-css">\n#side-left .sidebar-content p { margin: 0; padding-top: 2px; text-indent: 15px; font-size: 10px; height:15px; }\n#side-left .sidebar-content p:hover { color:#66ff33; }\n#side-left .sidebar-content p:first-child { padding-top: 0px !important; }\n#side-left .sidebar-content h1.users { text-indent: 8px; color: #66FFFF; font-size: 16px; }\n#side-left .sidebar-content h3.waitlistspot { color: #66FFFF; text-align: left; font-size: 15px; margin-left: 8px }\n#side-left .sidebar-content p span.admin_current,#side-left .sidebar-content p span.admin_meh,#side-left .sidebar-content p span.admin_undecided,#side-left .sidebar-content p span.admin_woot,#side-left .sidebar-content p span.ambassador_current,\n#side-left .sidebar-content p span.ambassador_meh,#side-left .sidebar-content p span.ambassador_undecided,#side-left .sidebar-content p span.ambassador_woot,#side-left .sidebar-content p span.bouncer_current,#side-left .sidebar-content p span.bouncer_meh,\n#side-left .sidebar-content p span.bouncer_undecided,#side-left .sidebar-content p span.bouncer_woot,#side-left .sidebar-content p span.host_current,#side-left .sidebar-content p span.host_meh,#side-left .sidebar-content p span.host_undecided,\n#side-left .sidebar-content p span.fdj_undecided,#side-left .sidebar-content p span.fdj_woot,#side-left .sidebar-content p span.fdj_meh,#side-left .sidebar-content p span.fdj_current,#side-left .sidebar-content p span.woot_undecided,#side-left .sidebar-content p span.curate_meh,#side-left .sidebar-content p span.curate_woot,\n#side-left .sidebar-content p span.plugcubed_undecided,#side-left .sidebar-content p span.plugcubed_woot,#side-left .sidebar-content p span.plugcubed_meh,#side-left .sidebar-content p span.plugcubed_current,\n#side-left .sidebar-content p span.host_woot,#side-left .sidebar-content p span.manager_current,#side-left .sidebar-content p span.manager_meh,#side-left .sidebar-content p span.manager_undecided,#side-left .sidebar-content p span.manager_woot,#side-left .sidebar-content p span.void {\n    background: url(http://tatdk.github.com/plugCubed/images/sprites.png) no-repeat;width:15px;height: 15px;position: relative;left: -5px;top:4px;display:inline-block\n}\n#side-left .sidebar-content p span.admin_current {background-position: -45px 0;}\n#side-left .sidebar-content p span.admin_meh {background-position: -30px 0;}\n#side-left .sidebar-content p span.admin_undecided {background-position: -15px 0;}\n#side-left .sidebar-content p span.admin_woot {background-position: 0 0;}\n#side-left .sidebar-content p span.ambassador_current {background-position: -45px -15px;}\n#side-left .sidebar-content p span.ambassador_meh {background-position: -30px -15px;}\n#side-left .sidebar-content p span.ambassador_undecided {background-position: -15px -15px;}\n#side-left .sidebar-content p span.ambassador_woot {background-position: 0 -15px;}\n#side-left .sidebar-content p span.bouncer_current {background-position: -45px -60px;}\n#side-left .sidebar-content p span.bouncer_meh {background-position: -30px -60px;}\n#side-left .sidebar-content p span.bouncer_undecided {background-position: -15px -60px;}\n#side-left .sidebar-content p span.bouncer_woot {background-position: 0 -60px;}\n#side-left .sidebar-content p span.host_current {background-position: -45px -30px;}\n#side-left .sidebar-content p span.host_meh {background-position: -30px -30px;}\n#side-left .sidebar-content p span.host_undecided {background-position: -15px -30px;}\n#side-left .sidebar-content p span.host_woot {background-position: 0 -30px;}\n#side-left .sidebar-content p span.manager_current {background-position: -45px -45px;}\n#side-left .sidebar-content p span.manager_meh {background-position: -30px -45px;}\n#side-left .sidebar-content p span.manager_undecided {background-position: -15px -45px;}\n#side-left .sidebar-content p span.manager_woot {background-position: 0 -45px;}\n#side-left .sidebar-content p span.fdj_current {background-position: -45px -75px;}\n#side-left .sidebar-content p span.fdj_meh {background-position: -30px -75px;}\n#side-left .sidebar-content p span.fdj_undecided {background-position: -15px -75px;}\n#side-left .sidebar-content p span.fdj_woot {background-position: 0 -75px;}\n#side-left .sidebar-content p span.plugcubed_current {background-position: -45px -90px;}\n#side-left .sidebar-content p span.plugcubed_meh {background-position: -30px -90px;}\n#side-left .sidebar-content p span.plugcubed_undecided {background-position: -15px -90px;}\n#side-left .sidebar-content p span.plugcubed_woot {background-position: 0 -90px;}\n#side-left .sidebar-content p span.curate_meh {background-position: -30px -105px;}\n#side-left .sidebar-content p span.curate_undecided {background-position: -15px -105px;}\n#side-left .sidebar-content p span.curate_woot {background-position: 0 -105px;}\n#side-left .sidebar-content p span.void {background-position: 0px -120px;}\n#plugcubed-gui { position: absolute; margin-left:-522px; top: -320px; }\n#plugcubed-gui h2 { background-color: #0b0b0b; height: 112px; width: 156px; margin: 0; color: #fff; font-size: 13px; font-variant: small-caps; padding: 8px 0 0 12px; border-top: 1px dotted #292929; }\n#plugcubed-gui ul {list-style-type:none; margin:0; padding:0;}\n#plugcubed-gui li {float:left;}\n#plugcubed-gui p { background: #0b0b0b; height: 32px; padding-top: 8px; padding-left: 8px; cursor: pointer; font-variant: small-caps; width: 84px; font-size: 15px; margin: 0; }\n#plugcubed-gui p:hover {background-color: #3C3C3C}\n#plugcubed-gui h1 { background-color: #0b0b0b; height: 32px; padding-top: 8px; padding-left: 8px; cursor: pointer; font-variant: small-caps; width: 84px; font-size: 20px; margin: 0; }\n.sidebar {\n    position: fixed;\n    top: 0;\n    height: 100%;\n    width: 200px;\n    z-index: 99999;\n    -moz-user-select: none;\n    -khtml-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n    background: rgb(69,72,77);\n    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzQ1NDg0ZCIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);\n    background: -moz-linear-gradient(top,  rgba(69,72,77,1) 0%, rgba(0,0,0,1) 100%);\n    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(69,72,77,1)), color-stop(100%,rgba(0,0,0,1)));\n    background: -webkit-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%);\n    background: -o-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%);\n    background: -ms-linear-gradient(top,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%);\n    background: linear-gradient(to bottom,  rgba(69,72,77,1) 0%,rgba(0,0,0,1) 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=\'#45484d\', endColorstr=\'#000000\',GradientType=0 );\n}\n.sidebar#side-left {\n    left: -220px;\n    z-index: 99999;\n}\n.sidebar#side-right {\n    right: -190px;\n    z-index: 99999;\n}\n.sidebar-handle {\n    width: 12px;\n    height: 100%;\n    z-index: 99999;\n    margin: 0;\n    padding: 0;\n    background: #474747;\n    box-shadow: 0px 0px 15px 0px rgba(0, 0, 0, .9);\n    cursor: "ne-resize";\n}\n.sidebar-handle span {\n    display: block;\n    position: absolute;\n    width: 10px;\n    top: 50%;\n    text-align: center;\n    letter-spacing: -1px;\n    color: #000;\n}\n#side-left .sidebar-handle {\nposition: absolute;\nright: 0;\ncursor: col-resize;\n}\n.sidebar-content {\n    position: absolute;\n    width: 185px;\n    float: left;\n    height: 100%;\n    padding: 15px;\n    overflow: scroll;\n}\n#side-left a {\n    display: block;\n    min-width: 100%;\n    cursor: pointer;\n    padding: 5px;\n    border-radius: 5px;\n}\n#side-left a span {\n    padding-right: 8px;\n}\n#side-left a:hover {\n    background-color: #333;\n}\n#side-left hr {\n    height: 0;\n    border: none;\n    border-top: 1px solid #AAA;\n    padding: 0;\n    margin: 10px 0;\n}\n#side-right .sidebar-handle {\n    float: left;\n}\n#side-right a {\n    display: block;\n    min-width: 100%;\n    cursor: pointer;\n    padding: 5px;\n    border-radius: 3px;\n}\n#side-right a span {\n    padding-right: 8px;\n}\n#side-right a:hover {\n    background-color: #333;\n}\n#side-right hr {\n    height: 0;\n    border: none;\n    border-top: 1px solid #AAA;\n    padding: 0;\n    margin: 10px 0px 10px 3px;\n}\n.sidebar-content ::-webkit-scrollbar {\n    width: 12px;\n}\n.sidebar-content ::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); \n    -webkit-border-radius: 10px;\n    border-radius: 10px;\n}\n.sidebar-content ::-webkit-scrollbar-thumb {\n    -webkit-border-radius: 10px;\n    border-radius: 10px;\n    background: rgba(255,255,255,255,0.4); \n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); \n}\n.sidebar-content ::-webkit-scrollbar-thumb:window-inactive {\n    background: rgba(255,255,255,255,0.2); \n}\n[class^="status-"], [class*=" status-"] {\n    border-radius: 50%;\n    width: 10px;\n    height: 10px;\n    background: yellow;\n    display: inline-block;\n    margin-right: 5px;\n}\n.status-on { background: green; }\n.status-off { background: red; }\n#dialog-custom-colors { width: 230px; height: 480px; }\n#dialog-custom-colors .dialog-body { height: 125px; }\n#dialog-custom-colors .dialog-default-button { right: 170px; width: 50px; }\n#dialog-custom-colors .dialog-cancel-button { right: 100px; }\n#dialog-custom-colors .dialog-submit-button { width: 75px; }\n#dialog-custom-colors .dialog-checkbox-container-enabled { left: 10px; top: 5px; }\n#dialog-custom-colors .dialog-input-background { width: 60px; left:150px; }\n#dialog-notify { width: 190px; height: 220px; }\n#dialog-notify .dialog-body { height: 125px; }\n#dialog-notify .dialog-cancel-button { width: 85px; right: 98px; }\n#dialog-notify .dialog-submit-button { width: 85px; right: 5px; }\n#dialog-notify .dialog-checkbox-container-enabled { left: 10px; top: 5px; }\n#dialog-notify .dialog-input-background { width: 60px; left:150px; }\n</style>');
$("body").append('<div id="side-left" class="sidebar">    <div class="sidebar-content"></div></div><div id="side-right" class="sidebar">    <div class="sidebar-handle"><span>||</span></div>    <div class="sidebar-content"></div></div>');$("body").append('<script type="text/javascript" id="plugcubed-js-extra">\n/**\n* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+\n* <http://cherne.net/brian/resources/jquery.hoverIntent.html>\n* \n* @param  f  onMouseOver function || An object with configuration options\n* @param  g  onMouseOut function  || Nothing (use configuration options object)\n* @author    Brian Cherne brian(at)cherne(dot)net\n*/\n(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind(\'mousemove\',track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type==\'mouseenter\'){pX=ev.pageX;pY=ev.pageY;$(ob).bind(\'mousemove\',track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind(\'mousemove\',track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind(\'mouseenter\',handleHover).bind(\'mouseleave\',handleHover)}})(jQuery);\nif (jQuery.easing.easeOutQuart === undefined) jQuery.easing.easeOutQuart = function (a,b,c,d,e) { return -d*((b=b/e-1)*b*b*b-1)+c; }\n$("#side-right")\n    .hoverIntent(function() {\n        var timeout_r = $(this)\n            .data("timeout_r");\n        if (timeout_r) {\n            clearTimeout(timeout_r);\n        }\n        $(this)\n            .animate({\n                "right": "0px"\n            }, 300, "easeOutQuart");\n    }, function() {\n        $(this)\n            .data("timeout_r", setTimeout($.proxy(function() {\n            $(this)\n                .animate({\n                    "right": "-190px"\n                }, 300, "easeOutQuart");\n       }, this), 500));\n    });\n\x3c/script>');
this.ta();this.ra();this.settings.userlist?(this.R(),this.aa()):this.ia();var b=API.getUsers(),c;for(c in b){var d=b[c];d.k===e&&(d.k=0);d.z===e&&(d.z=0);d.j===e&&(d.j=0);d.joinTime===e&&(d.joinTime=this.ha())}this.g=new SockJS("http://socket.plugpony.net:923/gateway");this.g.H=0;this.g.onopen=function(){this.H=0;this.send(JSON.stringify({id:Models.user.data.id}))};this.g.onmessage=function(b){"update"===JSON.parse(b.data).type&&(plugCubed.g.onclose=function(){},plugCubed.g.close(),plugCubed.log("A new version of plug&#179; has been released. Your script will reload in a few seconds.",
h,plugCubed.colors.u),setTimeout(function(){$.getScript("http://tatdk.github.io/plugCubed/compiled/plugCubed."+(plugCubed.ja?"min.":"")+"js")},5E3))};this.g.onclose=function(){this.H++;5>this.H?setTimeout(function(){plugCubed.g=new SockJS("http://socket.plugpony.net:923/gateway")},5E3):30>this.H?setTimeout(function(){plugCubed.g=new SockJS("http://socket.plugpony.net:923/gateway")},3E4):60>this.H&&setTimeout(function(){plugCubed.g=new SockJS("http://socket.plugpony.net:923/gateway")},6E4)}},close:function(){Models.chat.chatCommand=
Models.chat.B;ChatModel.chatCommand=ChatModel.B;API.removeEventListener(API.DJ_ADVANCE,this.proxy.O);API.removeEventListener(API.VOTE_UPDATE,this.proxy.onVoteUpdate);API.removeEventListener(API.CURATE_UPDATE,this.proxy.N);API.removeEventListener(API.USER_JOIN,this.proxy.P);API.removeEventListener(API.USER_LEAVE,this.proxy.Q);API.removeEventListener(API.CHAT,this.proxy.M);API.removeEventListener("userUpdate",this.proxy.i);for(var b in plugCubed.F)b===e||plugCubed.F[b]===e||($("#plugcubed-btn-"+b).unbind(),
delete plugCubed.F[b]);$("#plugcubed-css").remove();$("#plugcubed-js-extra").remove();$("#side-right").remove();$("#side-left").remove();this.J.remove();this.g.close()},aa:function(){$("#side-left").show().animate({left:"0px"},300,"easeOutQuart");this.K()&&(userlistShow===g&&$("#pdpUsers").hide(),$("#pdpUsersToggle").hide())},ia:function(){var b=-$("#side-left").width()-20;$("#side-left").animate({left:b+"px"},300,"easeOutQuart",function(){$("#side-left").hide()});this.K()&&(userlistShow===g&&$("#pdpUsers").show(),
$("#pdpUsersToggle").show())},settings:{recent:k,awaymsg:"",autowoot:k,autojoin:k,userlist:k,autorespond:k,menu:k,notify:k,customColors:k,colors:{you:"FFDD6F",regular:"B0B0B0",featureddj:"E90E82",bouncer:"E90E82",manager:"E90E82",cohost:"E90E82",host:"E90E82",ambassador:"9A50FF",admin:"42A5DC",join:"3366FF",leave:"3366FF",curate:"00FF00"},alerts:{join:k,leave:k,curate:k,ca:k,ba:k},A:[],C:k},wa:function(){if(localStorage.la!==e){var b=JSON.parse(localStorage.la),c;for(c in this.settings)b[c]!==e&&
(this.settings[c]=b[c]);this.settings.recent=k;this.settings.autowoot&&this.oa();this.settings.userlist&&(this.R(),this.aa());this.settings.customColors&&this.na();0<this.settings.A.length&&-1<this.settings.A.indexOf(Models.room.data.media.id)&&(Playback.setVolume(0),this.settings.C=g,this.log(Models.room.data.media.title+" auto-muted.",h,this.colors.f))}},saveSettings:function(){localStorage.la=JSON.stringify(this.settings)},na:function(){this.settings.customColors?this.J.text([".chat-message .chat-from,",
".chat-mention .chat-from { color:#"+this.settings.colors.regular+"!important; }",".chat-message .chat-from-featureddj,",".chat-mention .chat-from-featureddj { color:#"+this.settings.colors.featureddj+"!important; }",".chat-message .chat-from-bouncer,",".chat-mention .chat-from-bouncer { color:#"+this.settings.colors.bouncer+"!important; }",".chat-message .chat-from-manager,",".chat-mention .chat-from-manager { color:#"+this.settings.colors.manager+"!important; }",".chat-message .chat-from-cohost,",
".chat-mention .chat-from-cohost { color:#"+this.settings.colors.cohost+"!important; }",".chat-message .chat-from-host,",".chat-mention .chat-from-host { color:#"+this.settings.colors.host+"!important; }",".chat-message .chat-from-ambassador,",".chat-mention .chat-from-ambassador { color:#"+this.settings.colors.ambassador+"!important; }",".chat-message .chat-from-admin,",".chat-mention .chat-from-admin { color:#"+this.settings.colors.admin+"!important; }",".chat-message .chat-from-you,",".chat-mention .chat-from-you { color:#"+
this.settings.colors.you+"!important; }"].join("\n")):this.J.text("")},ra:function(){API.addEventListener(API.DJ_ADVANCE,this.proxy.O);API.addEventListener(API.VOTE_UPDATE,this.proxy.onVoteUpdate);API.addEventListener(API.CURATE_UPDATE,this.proxy.N);API.addEventListener(API.USER_JOIN,this.proxy.P);API.addEventListener(API.USER_LEAVE,this.proxy.Q);API.addEventListener(API.CHAT,this.proxy.M);API.addEventListener(API.VOTE_SKIP,this.proxy.G);API.addEventListener(API.USER_SKIP,this.proxy.G);API.addEventListener(API.MOD_SKIP,
this.proxy.G);API.addEventListener("userUpdate",this.proxy.i)},ta:function(){this.q(this.settings.autowoot,"woot","Autowoot",this.proxy.menu.V);this.q(this.settings.autojoin,"join","Autojoin",this.proxy.menu.U);this.q(this.settings.userlist,"userlist","Userlist",this.proxy.menu.Z);this.q(this.settings.customColors,"colors","Custom Chat Colors",this.proxy.menu.W);this.q(this.settings.autorespond,"autorespond","AFK Status",this.proxy.menu.T);this.q(this.settings.notify,"notify","Notify",this.proxy.menu.X);
this.q(!DB.settings.streamDisabled,"stream","Stream",this.proxy.menu.Y)},q:function(b,c,d,f){this.F[c]===e&&(0<$("#side-right .sidebar-content").children().length&&$("#side-right .sidebar-content").append("<hr />"),$("#side-right .sidebar-content").append('<a id="plugcubed-btn-'+c+'"><div class="status-'+(b?"on":"off")+'"></div>'+d+"</a>"),$("#plugcubed-btn-"+c).click(f),this.F[c]={text:d,callback:f})},d:function(b,c){$("#plugcubed-btn-"+b).find('[class^="status-"], [class*=" status-"]').attr("class",
"status-"+(c===g?"on":"off"))},R:function(){0<$("#side-left .sidebar-content").children().length&&$("#side-left .sidebar-content").append("<hr />");$("#side-left .sidebar-content").bind("contextmenu",function(){return k});$("#side-left .sidebar-content").html('<h1 class="users">Users: '+API.getUsers().length+"</h1>");var b=Models.room.getWaitListPosition(),b=$("<h3></h3>").addClass("waitlistspot").text("Waitlist: "+(b!==h?b+" / ":"")+Models.room.data.waitList.length);$("#side-left .sidebar-content").append(b).append("<hr />");
var b=API.getUsers(),c;for(c in b)this.pa(b[c])},log:function(b,c,d,f){var l="";d&&(l='style="color:'+d+';"');b=c?'<div class="chat-message"><span class="chat-from" '+l+">"+c+'</span><span class="chat-text" '+l+">: "+b+"</span></div>":'<div class="chat-message"><span class="chat-text" '+l+">"+b+"</span></div>";$("#chat-messages");$("#chat-messages").scrollTop();$("#chat-messages").outerHeight();c=Popout?Popout.Chat.chatMessages:Chat.chatMessages;d=c.scrollTop()>c[0].scrollHeight-c.height()-20;c.append(b);
d&&c.scrollTop(c[0].scrollHeight);f&&$(b).click(function(){this.childNodes[0].style.color=f})},pa:function(b){var c=Utils.cleanTypedString(b.username),d;d=b.curated==g?"curate":this.D(b.id)?"plugcubed":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.FEATUREDDJ?"fdj":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.BOUNCER?"bouncer":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.MANAGER?"manager":Models.room.data.staff[b.id]&&
Models.room.data.staff[b.id]==Models.user.COHOST?"host":Models.room.data.staff[b.id]&&5==Models.room.data.staff[b.id]?"host":Models.room.ambassadors[b.id]?"ambassador":Models.room.admins[b.id]?"admin":"normal";0<Models.room.data.djs.length&&Models.room.data.djs[0].user.id==b.id?"normal"===d?this.I("void","#66FFFF",c):this.I(d+"_current","#66FFFF",c):"normal"===d?this.I("void",this.ea(b.vote),c):this.I(d+this.Ca(b.vote),this.ea(b.vote),c)},ea:function(b){var c="";if(b===e)c="FFFFFF";else switch(b){case -1:c=
"ED1C24";break;case 1:c="3FFF00";break;default:c="FFFFFF"}return"#"+c},Ca:function(b){var c="";if(b===e)c="undecided";else switch(b){case -1:c="meh";break;case 1:c="woot";break;default:c="undecided"}return"_"+c},I:function(b,c,d){$("#side-left .sidebar-content").append($("<p></p>").append($("<span></span>").append($("<span></span>").addClass(b)).css("cursor","pointer").css("color",c).mousedown(function(b){switch(b.which){case 1:$("#chat-input-field").val($("#chat-input-field").val()+"@"+d+" ").focus();
break;case 3:(Models.room.data.staff[Models.user.data.id]&&Models.room.data.staff[Models.user.data.id]>=Models.user.BOUNCER||plugCubed.D(Models.user.data.id))&&plugCubed.L(d)}}).html(function(b,c){return c+d})))},getUser:function(b){b=b.trim();"@"===b.substr(0,1)&&(b=b.substr(1));var c=API.getUsers(),d;for(d in c)if(c[d].username.toLowerCase()===b.toLowerCase()||c[d].id.toLowerCase()===b.toLowerCase())return c[d];return h},S:function(b,c){if(Models.room.data.staff[Models.user.data.id]&&Models.room.data.staff[Models.user.data.id]>=
Models.user.BOUNCER){var d;switch(c){case "kick":d=ModerationKickUserService;break;case "removedj":d=ModerationRemoveDJService;break;case "adddj":d=ModerationAddDJService;break;default:log("Unknown moderation");return}var f=this.getUser(b);f===h?log("user not found"):new d(f.id," ")}},L:function(b){b=this.getUser(b);if(b===h)log("user not found");else{var c,d,f,l,p=b.djPoints+b.curatorPoints+b.listenerPoints,n=b.k+b.z;f=Models.room.getWaitListPosition(b.id);d=-1;c=Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==
Models.user.FEATUREDDJ?"Featured DJ":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.BOUNCER?"Bouncer":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.MANAGER?"Manager":Models.room.data.staff[b.id]&&Models.room.data.staff[b.id]==Models.user.COHOST?"Co-Host":Models.room.data.staff[b.id]&&5==Models.room.data.staff[b.id]?"Host":Models.room.ambassadors[b.id]?"Ambassador":Models.room.admins[b.id]?"Admin":"User";if(f===h)if(Models.room.data.djs[0].user.id===
b.id)l="Currently DJing";else{for(f=1;f<Models.room.data.djs.length;f++)d=Models.room.data.djs[f].user.id===b.id?f:d;l=0>d?"Not in waitlist nor booth":d+1+"/"+Models.room.data.djs.length+" in booth"}else l=f+"/"+Models.room.data.waitList.length+" in waitlist";switch(b.status){case -1:d="Idle";break;default:d="Available";break;case 1:d="AFK";break;case 2:d="Working";break;case 3:d="Sleeping"}switch(b.vote){case -1:f="Meh";break;default:f="Undecided";break;case 1:f="Woot"}log('<table style="width:100%;color:#CC00CC"><tr><td colspan="2"><strong>Name</strong>: <span style="color:#FFFFFF">'+
b.username+"</span></td></tr>"+(this.D(b.id)?'<tr><td colspan="2"><strong>Title</strong>: <span style="color:#FFFFFF">plugCubed Developer</span></td></tr>':"")+'<tr><td colspan="2"><strong>ID</strong>: <span style="color:#FFFFFF">'+b.id+'</span></td></tr><tr><td><strong>Rank</strong>: <span style="color:#FFFFFF">'+c+'</span></td><td><strong>Time Joined</strong>: <span style="color:#FFFFFF">'+b.joinTime+'</span></td></tr><tr><td><strong>Status</strong>: <span style="color:#FFFFFF">'+d+'</span></td><td><strong>Vote</strong>: <span style="color:#FFFFFF">'+
f+'</span></td></tr><tr><td colspan="2"><strong>Position</strong>: <span style="color:#FFFFFF">'+l+'</span></td></tr><tr><td><strong>Points</strong>: <span style="color:#FFFFFF">'+p+'</span></td><td><strong>Fans</strong>: <span style="color:#FFFFFF">'+b.fans+'</span></td></tr><tr><td><strong>Woot Count</strong>: <span style="color:#FFFFFF">'+b.k+'</span></td><td><strong>Meh Count</strong>: <span style="color:#FFFFFF">'+b.z+'</span></td></tr><tr><td colspan="2"><strong>Woot/Meh ratio</strong>: <span style="color:#FFFFFF">'+
(0===n?"0":(b.k/n).toFixed(2))+"</span></td></tr></table>")}},V:function(){this.settings.autowoot=!this.settings.autowoot;this.d("woot",this.settings.autowoot);this.settings.autowoot&&$("#button-vote-positive").click();this.saveSettings()},U:function(){this.settings.autojoin=!this.settings.autojoin;this.d("join",this.settings.autojoin);this.settings.autojoin&&0<$("#button-dj-waitlist-join").length&&API.waitListJoin();this.saveSettings()},Z:function(){this.settings.userlist=!this.settings.userlist;
this.d("userlist",this.settings.userlist);this.settings.userlist?(this.R(),this.aa()):($("#side-left .sidebar-content").empty(),this.ia());this.saveSettings()},T:function(){this.settings.autorespond=!this.settings.autorespond;this.d("autorespond",this.settings.autorespond);if(this.settings.autorespond){var b=prompt("Please enter your away message here.\nThis is what you will reply via @mention.",""===this.settings.awaymsg?this.ga:this.settings.awaymsg);if(b===h){this.settings.autorespond=k;this.d("autorespond",
k);return}b=b.split("@").join("").trim();this.settings.awaymsg=""===b?this.ga:b;0>=Models.user.data.status&&Models.user.changeStatus(1)}else Models.user.changeStatus(0);this.saveSettings()},X:function(){Dialog.closeDialog();Dialog.context="isNotifySettings";Dialog.submitFunc=$.proxy(this.Ba,this);Dialog.showDialog($("<div/>").attr("id","dialog-notify").addClass("dialog").css("left",Main.LEFT+(Main.WIDTH-230)/2).css("top",208.5).append(Dialog.getHeader("Chat Notifications")).append($("<div/>").addClass("dialog-body").append($("<form/>").submit("return false").append(Dialog.getCheckBox("Enable alerts",
"enabled",this.settings.notify).css("top",10).css("left",10)).append(Dialog.getCheckBox("User Join","join",this.settings.alerts.join).css("top",30).css("left",30)).append(Dialog.getCheckBox("User Leave","leave",this.settings.alerts.leave).css("top",50).css("left",30)).append(Dialog.getCheckBox("User Curate","curate",this.settings.alerts.curate).css("top",70).css("left",30)).append(Dialog.getCheckBox("Song Stats","songStats",this.settings.alerts.ba).css("top",90).css("left",30)).append(Dialog.getCheckBox("Song Updates",
"songUpdate",this.settings.alerts.ca).css("top",110).css("left",30)))).append(Dialog.getCancelButton()).append(Dialog.getSubmitButton(Lang.dialog.save)))},Ba:function(){this.settings.notify=$("#dialog-checkbox-enabled").is(":checked");this.settings.alerts.join=$("#dialog-checkbox-join").is(":checked");this.settings.alerts.leave=$("#dialog-checkbox-leave").is(":checked");this.settings.alerts.curate=$("#dialog-checkbox-curate").is(":checked");this.settings.alerts.ba=$("#dialog-checkbox-songStats").is(":checked");
this.settings.alerts.ca=$("#dialog-checkbox-songUpdate").is(":checked");this.d("notify",this.settings.notify);this.saveSettings();Dialog.closeDialog()},Y:function(){this.d("stream",DB.settings.streamDisabled);API.sendChat(DB.settings.streamDisabled?"/stream on":"/stream off")},W:function(){Dialog.closeDialog();Dialog.context="isCustomChatColors";Dialog.submitFunc=$.proxy(this.ya,this);Dialog.showDialog($("<div/>").attr("id","dialog-custom-colors").addClass("dialog").css("left",Main.LEFT+(Main.WIDTH-
230)/2).css("top",208.5).append(Dialog.getHeader("Custom Chat Colors")).append($("<div/>").addClass("dialog-body").append($("<form/>").submit("return false").append(Dialog.getCheckBox("Enable custom","enabled",this.settings.customColors)).append($(Dialog.getInputField("you","You","FFDD6F",this.settings.colors.you,6)).css("top",30)).append($(Dialog.getInputField("regular","Regular","B0B0B0",this.settings.colors.regular,6)).css("top",60)).append($(Dialog.getInputField("featureddj","Featured DJ","E90E82",
this.settings.colors.featureddj,6)).css("top",90)).append($(Dialog.getInputField("bouncer","Bouncer","E90E82",this.settings.colors.bouncer,6)).css("top",120)).append($(Dialog.getInputField("manager","Manager","E90E82",this.settings.colors.manager,6)).css("top",150)).append($(Dialog.getInputField("cohost","Co-Host","E90E82",this.settings.colors.cohost,6)).css("top",180)).append($(Dialog.getInputField("host","Host","E90E82",this.settings.colors.host,6)).css("top",210)).append($(Dialog.getInputField("ambassador",
"Ambassador","9A50FF",this.settings.colors.ambassador,6)).css("top",240)).append($(Dialog.getInputField("admin","Admin","42A5DC",this.settings.colors.admin,6)).css("top",270)).append($(Dialog.getInputField("join","User Join","3366FF",this.settings.colors.join,6)).css("top",300)).append($(Dialog.getInputField("leave","User Leave","3366FF",this.settings.colors.leave,6)).css("top",330)).append($(Dialog.getInputField("curate","User Curate","00FF00",this.settings.colors.curate,6)).css("top",360)))).append($("<div/>").addClass("dialog-button dialog-default-button").click($.proxy(this.xa,
this)).append($("<span/>").text("Default"))).append(Dialog.getCancelButton()).append(Dialog.getSubmitButton(Lang.dialog.save)))},xa:function(){var b=$("input[name=you]"),c=$("input[name=regular]"),d=$("input[name=featureddj]"),f=$("input[name=bouncer]"),l=$("input[name=manager]"),p=$("input[name=cohost]"),n=$("input[name=host]"),q=$("input[name=ambassador]"),r=$("input[name=admin]"),s=$("input[name=join]"),t=$("input[name=leave]"),u=$("input[name=curate]");b.val(b.data("ph"));c.val(c.data("ph"));
d.val(d.data("ph"));f.val(f.data("ph"));l.val(l.data("ph"));p.val(p.data("ph"));n.val(n.data("ph"));q.val(q.data("ph"));r.val(r.data("ph"));s.val(s.data("ph"));t.val(t.data("ph"));u.val(u.data("ph"))},ya:function(){var b=$("input[name=you]"),c=$("input[name=regular]"),d=$("input[name=featureddj]"),f=$("input[name=bouncer]"),l=$("input[name=manager]"),p=$("input[name=cohost]"),n=$("input[name=host]"),q=$("input[name=ambassador]"),r=$("input[name=admin]"),s=$("input[name=join]"),t=$("input[name=leave]"),
u=$("input[name=curate]");this.settings.customColors=$("#dialog-checkbox-enabled").is(":checked");this.settings.colors.you=""===b.val()||!m(b.val())?b.data("ph"):b.val();this.settings.colors.regular=""===c.val()||!m(c.val())?c.data("ph"):c.val();this.settings.colors.featureddj=""===d.val()||!m(d.val())?d.data("ph"):d.val();this.settings.colors.bouncer=""===f.val()||!m(f.val())?f.data("ph"):f.val();this.settings.colors.manager=""===l.val()||!m(l.val())?l.data("ph"):l.val();this.settings.colors.cohost=
""===p.val()||!m(p.val())?p.data("ph"):p.val();this.settings.colors.host=""===n.val()||!m(n.val())?n.data("ph"):n.val();this.settings.colors.ambassador=""===q.val()||!m(q.val())?q.data("ph"):q.val();this.settings.colors.admin=""===r.val()||!m(r.val())?r.data("ph"):r.val();this.settings.colors.join=""===s.val()||!m(s.val())?s.data("ph"):s.val();this.settings.colors.leave=""===t.val()||!m(t.val())?t.data("ph"):t.val();this.settings.colors.curate=""===u.val()||!m(u.val())?u.data("ph"):u.val();this.na();
this.d("colors",this.settings.customColors);this.saveSettings();Dialog.closeDialog()},onVoteUpdate:function(b){if(b&&b.user){var c=Models.room.userHash[b.user.id];this.i();0!==c.j&&(1==c.j?c.k--:-1==c.j&&c.z--);1==b.vote?c.k++:-1==b.vote&&c.z++;c.j=b.vote}},N:function(b){var c=API.getMedia();this.settings.notify===g&&this.settings.alerts.curate===g&&this.log(b.user.username+" added "+c.author+" - "+c.title,h,"#"+this.settings.colors.curate);Models.room.userHash[b.user.id].curated=g;this.i()},O:function(b){this.settings.notify===
g&&(this.settings.alerts.ba===g&&this.log("Stats:   "+b.lastPlay.score.positive+" woots -- "+b.lastPlay.score.negative+" mehs -- "+b.lastPlay.score.curates+" curates",h,this.colors.f),this.settings.alerts.ca===g&&this.log("Now Playing: "+b.media.title+" by "+b.media.author+"<br />Played by: "+b.dj.username,h,this.colors.u));setTimeout($.proxy(this.za,this),1E3*Math.Da());(Models.user.getPermission()>=Models.user.BOUNCER||this.D(Models.user.data.id))&&this.Aa(b.media.id);plugCubed.history.unshift({id:b.media.id,
author:b.media.author,title:b.media.title,da:k,user:{id:b.dj.id,username:b.dj.username}});plugCubed.history.splice(50,plugCubed.history.length-50);this.settings.C&&0>this.settings.A.indexOf(b.media.id)&&(setTimeout(function(){Playback.setVolume(Playback.lastVolume)},800),this.settings.C=k);!this.settings.C&&-1<this.settings.A.indexOf(b.media.id)&&(setTimeout(function(){Playback.setVolume(0)},800),this.settings.C=g,this.log(b.media.title+" auto-muted.",h,this.colors.f));this.i();b=API.getUsers();for(var c in b)b[c].j=
0},za:function(){this.settings.autowoot&&0>this.settings.A.indexOf(Models.room.data.media.id)&&this.oa();if("block"===$("#button-dj-waitlist-join").css("display")&&this.settings.autojoin)Room.onWaitListJoinClick()},oa:function(){if(0!==Models.room.data.djs.length){var b=Models.room.data.djs[0];b===h||b==API.getSelf()||$("#button-vote-positive").click()}},P:function(b){this.settings.notify===g&&this.settings.alerts.join===g&&this.log(Utils.cleanTypedString(b.username+" joined the room"),h,"#"+this.settings.colors.join);
b=Models.room.userHash[b.id];b.k===e&&(b.k=0);b.z===e&&(b.z=0);b.j===e&&(b.j=0);b.joinTime===e&&(b.joinTime=this.ha());this.i()},Q:function(b){this.settings.notify===g&&this.settings.alerts.leave===g&&this.log(Utils.cleanTypedString(b.username+" left the room"),h,"#"+this.settings.colors.leave);this.i()},D:function(b){return"50aeb31696fba52c3ca0adb6"==b||"50aeb077877b9217e2fbff00"==b},M:function(b){var c=0>b.message.indexOf("@")&&this.D(b.fromID);if("mention"==b.type&&Models.room.data.staff[b.fromID]&&
Models.room.data.staff[b.fromID]>=Models.user.BOUNCER||c)if(-1<b.message.indexOf("!disable")&&(this.settings.autojoin?(this.settings.autojoin=k,this.d("join",this.settings.autojoin),this.saveSettings(),API.waitListLeave(),API.sendChat("@"+b.from+" Autojoin disabled")):API.sendChat("@"+b.from+" Autojoin was not enabled")),-1<b.message.indexOf("!afkdisable")&&(this.settings.autorespond?(this.settings.autorespond=k,this.d("autorespond",this.settings.autorespond),this.saveSettings(),API.sendChat("@"+
b.from+" AFK message disabled")):API.sendChat("@"+b.from+" AFK message was not enabled")),0<b.message.indexOf("!disable")||0<b.message.indexOf("!afkdisable"))return;"mention"==b.type&&(this.settings.autorespond&&!this.settings.recent)&&(this.settings.recent=g,setTimeout(function(){plugCubed.settings.recent=k;plugCubed.saveSettings()},18E4),API.sendChat("@"+b.from+" "+this.settings.awaymsg))},i:function(){this.settings.userlist&&this.R()},qa:function(){(new HistorySelectService).successCallback=$.proxy(this.va,
this)},va:function(b){plugCubed.history=[];for(var c in b){var d=b[c];plugCubed.history.push({id:d.media.id,author:d.media.author,title:d.media.title,da:k,user:{id:d.user.id.toString(),username:d.user.username}})}},G:function(){plugCubed.history[1].da=g},Aa:function(b){var c=-1,d;for(d in plugCubed.history){var f=plugCubed.history[d];if(f.id==b&&51>~~d+2&&(c=~~d+2,!f.da))return Models.chat.onChatReceived({type:"system",message:"Song is in history ("+c+" of "+plugCubed.history.length+")",language:Models.user.data.language})}if(0<
c)return Models.chat.onChatReceived({type:"system",message:"Song is in history ("+c+" of "+plugCubed.history.length+"), but was skipped on the last play",language:Models.user.data.language})},ha:function(){var b=new Date,c=b.getMinutes();return b.getHours()+":"+((10>c?"0":"")+c)},fa:function(b){if(Models.chat.B(b)===g)return("/stream on"==b||"/stream off"==b)&&plugCubed.d("stream",!DB.settings.streamDisabled),"/afk"==b&&plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=k,plugCubed.d("join",
k),plugCubed.saveSettings()),g;if(0===b.indexOf("/commands")){b=[["/nick","change username"],["/idle","set status to idle"],["/avail","set status to available"],["/afk","set status to afk"],["/work","set status to working"],["/sleep","set status to sleeping"],["/join","join dj booth/waitlist"],["/leave","leaves dj booth/waitlist"],["/whoami","get your own information"],["/mute","set volume to 0"],["/automute","register currently playing song to automatically mute on future plays"],["/unmute","set volume to last volume"],
["/woot","woots current song"],["/meh","mehs current song"],["/refresh","refresh the video"],["/curate","add current song to your selected playlist"],["/getpos","get current waitlist position"],["/version","displays version number"],["/commands","shows this list"]];var c="<table>",d;for(d in b)c+="<tr><td>"+b[d][0]+"</td><td>"+b[d][1]+"</td></tr>";c+="</table>";if(Models.user.hasPermission(Models.user.BOUNCER)){b=[["/whois (username)","gives general information about user",Models.user.BOUNCER],["/skip",
"skip current song",Models.user.BOUNCER],["/kick (username)","kicks targeted user",Models.user.BOUNCER],["/lock","locks DJ booth",Models.user.MANAGER],["/unlock","unlocks DJ booth",Models.user.MANAGER],["/add (username)","adds targeted user to dj booth/waitlist",Models.user.BOUNCER],["/remove (username)","removes targeted user from dj booth/waitlist",Models.user.BOUNCER]];var f="<table>";for(d in b)Models.user.hasPermission(b[d][2])&&(f+="<tr><td>"+b[d][0]+"</td><td>"+b[d][1]+"</td></tr>");Dialog.ma(c,
f+"</table>")}else Dialog.ma(c);return g}if("/idle"==b)return Models.user.changeStatus(-1),g;if("/avail"==b||"/available"==b)return Models.user.changeStatus(0),g;if("/brb"==b||"/away"==b)return Models.user.changeStatus(1),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=k,plugCubed.d("join",k),plugCubed.saveSettings()),g;if("/work"==b||"/working"==b)return Models.user.changeStatus(2),g;if("/sleep"==b||"/sleeping"==b)return Models.user.changeStatus(3),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=
k,plugCubed.d("join",k),plugCubed.saveSettings()),g;if("/join"==b)return Room.onWaitListJoinClick(),g;if("/leave"==b)return API.waitListLeave(),g;if("/whoami"==b)return plugCubed.L(Models.user.data.id),g;if("/woot"==b)return $("#button-vote-positive").click(),g;if("/meh"==b)return $("#button-vote-negative").click(),g;if("/refresh"==b)return $("#button-refresh").click(),g;if("/version"==b)return plugCubed.log("Running plug&#179; version "+plugCubed.version.major+"."+plugCubed.version.minor+"."+plugCubed.version.ka,
h,plugCubed.colors.u),g;if("/mute"==b)return Playback.setVolume(0),g;if("/unmute"==b)return Playback.setVolume(Playback.lastVolume),g;if(plugCubed.K()&&"/muteone"==b||plugCubed.K()&&"/singlemute"==b)return $("#button-sound").click(),$("#button-sound").click(),g;if(0===b.indexOf("/nick "))return Models.user.changeDisplayName(b.substr(6)),g;if(0===b.indexOf("/curate"))return new DJCurateService(Models.playlist.selectedPlaylistID),setTimeout(function(){Dialog.closeDialog()},500),g;if("/nextsong"==b)return d=
Models.playlistMedia(Models.playlist.selectedPlaylistID).data[0],plugCubed.log("Your next queued song is "+d.title+" by "+d.author,h,plugCubed.colors.u),g;if("/automute"==b)return 0>plugCubed.settings.A.indexOf(Models.room.data.media.id)&&(plugCubed.settings.A.push(Models.room.data.media.id),plugCubed.settings.C=g,Playback.setVolume(0),plugCubed.log(Models.room.data.media.title+" registered to auto-mute on future plays.",h,plugCubed.colors.f),plugCubed.saveSettings()),g;if("/alertsoff"==b)return plugCubed.settings.notify&&
(plugCubed.log("Join/leave alerts disabled",h,plugCubed.colors.u),plugCubed.settings.notify=k,plugCubed.d("notify",k)),g;if("/alertson"==b)return plugCubed.settings.notify||(plugCubed.log("Join/leave alerts enabled",h,plugCubed.colors.u),plugCubed.settings.notify=g,plugCubed.d("notify",g)),g;if(0===b.indexOf("/getpos")){d=plugCubed.getUser(b.substr(7));b=d===h?Models.user.data:d;c=Models.room.getWaitListPosition(b.id);if(c!==h)plugCubed.log("Position in waitlist "+c+"/"+Models.room.data.waitList.length,
h,plugCubed.colors.f);else{c=-1;for(d=0;d<Models.room.data.djs.length;d++)c=Models.room.data.djs[d].user.id===b.id?d:c;0>c?plugCubed.log("Not in waitlist nor booth",h,plugCubed.colors.f):0===c?plugCubed.log((b.id===Models.user.data.id?"You":b.username)+" are currently DJing",h,plugCubed.colors.f):1===c?plugCubed.log((b.id===Models.user.data.id?"You":b.username)+" are DJing next",h,plugCubed.colors.f):plugCubed.log("Position in booth "+(c+1)+"/"+Models.room.data.djs.length,h,plugCubed.colors.f)}return g}if(plugCubed.D(Models.user.data.id)&&
0===b.indexOf("/whois "))return plugCubed.L(b.substr(7)),g;if(Models.user.hasPermission(Models.user.BOUNCER)){if(0===b.indexOf("/skip")){if(Models.room.data.djs[0].user.id==Models.user.data.id)Room.onSkipClick();else d=b.substr(5).trim(),b=plugCubed.getUser(Models.room.data.currentDJ),d&&API.sendChat((b!=h?"@"+b.username+" - ":"")+"Reason for skip: "+d),new ModerationForceSkipService;return g}if(0===b.indexOf("/whois "))return plugCubed.L(b.substr(7)),g;if(0===b.indexOf("/kick "))if(0<b.indexOf("::")){d=
b.substr(5).split(":: ");c=60;if(2==d.length)return!isNaN(parseInt(d[1],10))&&isFinite(d[1])&&(c=parseFloat(d[1])),b=plugCubed.getUser(d[0]),new ModerationKickUserService(b.id,!isNaN(parseInt(d[1],10))&&isFinite(d[1])?" ":d[1],c),g;if(3==d.length)return c=parseFloat(d[2]),b=plugCubed.getUser(d[0]),new ModerationKickUserService(b.id,d[1],c),g}else return plugCubed.S(b.substr(6),"kick"),g;if(0===b.indexOf("/add "))return plugCubed.S(b.substr(5),"adddj"),g;if(0===b.indexOf("/remove "))return plugCubed.S(b.substr(8),
"removedj"),g}if(Models.user.hasPermission(Models.user.MANAGER)){if(0===b.indexOf("/lock"))return new RoomPropsService(document.location.href.split("/")[3],g,Models.room.data.waitListEnabled,Models.room.data.maxPlays,Models.room.data.maxDJs),g;if(0===b.indexOf("/unlock"))return new RoomPropsService(document.location.href.split("/")[3],k,Models.room.data.waitListEnabled,Models.room.data.maxPlays,Models.room.data.maxDJs),g}return k}}));plugCubed.ja=g;
